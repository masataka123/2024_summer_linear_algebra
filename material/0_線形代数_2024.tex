\documentclass[dvipdfmx,a4paper,11pt]{article}
\usepackage[utf8]{inputenc}
%\usepackage[dvipdfmx]{hyperref} %リンクを有効にする
\usepackage{url} %同上
\usepackage{amsmath,amssymb} %もちろん
\usepackage{amsfonts,amsthm,mathtools} %もちろん
\usepackage{braket,physics} %あると便利なやつ
\usepackage{bm} %ラプラシアンで使った
\usepackage[top=30truemm,bottom=30truemm,left=25truemm,right=25truemm]{geometry} %余白設定
\usepackage{latexsym} %ごくたまに必要になる
\renewcommand{\kanjifamilydefault}{\gtdefault}
\usepackage{otf} %宗教上の理由でmin10が嫌いなので


\usepackage[all]{xy}
\usepackage{amsthm,amsmath,amssymb,comment}
\usepackage{amsmath}    % æ°å­¦ç¨
\usepackage{amssymb}  
\usepackage{color}
\usepackage{amscd}
\usepackage{amsthm}  
\usepackage{wrapfig}
\usepackage{comment}	
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{pxrubrica}
\usepackage{enumitem}
\usepackage{mathrsfs} 
\usepackage[colorlinks,linkcolor=red,anchorcolor=blue,citecolor=blue]{hyperref} 
\setstretch{1.2}
\usepackage{pgfplots}


\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}} 
\newcommand{\N}{\mathbb{N}}
\newcommand{\C}{\mathbb{C}} 
\newcommand{\Sin}{\text{Sin}^{-1}} 
\newcommand{\Cos}{\text{Cos}^{-1}} 
\newcommand{\Tan}{\text{Tan}^{-1}} 
\newcommand{\invsin}{\text{Sin}^{-1}} 
\newcommand{\invcos}{\text{Cos}^{-1}} 
\newcommand{\invtan}{\text{Tan}^{-1}} 
\newcommand{\Area}{S}
\newcommand{\vol}{\text{Vol}}
\newcommand{\maru}[1]{\raise0.2ex\hbox{\textcircled{\tiny{#1}}}}
\newcommand{\sgn}{{\rm sgn}}
%\newcommand{\rank}{{\rm rank}}



   %当然のようにやる．
\allowdisplaybreaks[4]
   %もちろん．
%\title{第1回. 多変数の連続写像 (岩井雅崇, 2020/10/06)}
%\author{岩井雅崇}
%\date{2020/10/06}
%ここまで今回の記事関係ない
\usepackage{tcolorbox}
\tcbuselibrary{breakable, skins, theorems}

\theoremstyle{definition}
\newtheorem{thm}{定理}
\newtheorem{lem}[thm]{補題}
\newtheorem{prop}[thm]{命題}
\newtheorem{cor}[thm]{系}
\newtheorem{claim}[thm]{主張}
\newtheorem{dfn}[thm]{定義}
\newtheorem{rem}[thm]{注意}
\newtheorem{exa}[thm]{例}
\newtheorem{conj}[thm]{予想}
\newtheorem{prob}[thm]{問題}
\newtheorem{rema}[thm]{補足}
\newtheorem{dfnthm}[thm]{定義・定理}
\newtheorem{ques}[thm]{問題}

\DeclareMathOperator{\Ric}{Ric}
\DeclareMathOperator{\Vol}{Vol}
 \newcommand{\pdrv}[2]{\frac{\partial #1}{\partial #2}}
 \newcommand{\drv}[2]{\frac{d #1}{d#2}}
  \newcommand{\ppdrv}[3]{\frac{\partial #1}{\partial #2 \partial #3}}
  
  \newcommand{\xb}[1]{\textcolor{blue}{#1}}
\newcommand{\xr}[1]{\textcolor{red}{#1}}
\newcommand{\xm}[1]{\textcolor{magenta}{#1}}

\title{2024年度春夏学期 \\ 大阪大学 全学共通教育科目 \\線形代数学I 工（理63〜123）}
\author{岩井雅崇 (大阪大学)}
\date{\today \, ver 1.00}
%ここから本文．
\begin{document}

\maketitle
\tableofcontents
\newpage

\begin{center}
\setcounter{section}{-1}
\section{ガイダンス}
\label{sec-guide}
\end{center}

\begin{center}
{\Large 2024年度春夏学期 \\ 大阪大学 全学共通教育科目 線形代数学I 工（理63〜123）} \\
水曜3限(13:30-15:00) 共C301
\end{center}
\begin{flushright}
 岩井雅崇(いわいまさたか) \\
\end{flushright}
{\Large \underline{基本的事項}}
\begin{itemize}
  \setlength{\parskip}{0cm} % 段落間
  \setlength{\itemsep}{0cm} % 項目間
\item この授業は\underline{対面授業}です. \underline{水曜3限(13:30-15:00)に共C301}にて授業を行います.
\item 授業ホームページ(\url{https://masataka123.github.io/2024_summer_linear_algebra/})にて「授業の資料・授業の板書」などをアップロードしていきます. 
QRコードは下にあります.
\begin{figure}[htbp]
\begin{center}
 \includegraphics[height=30mm, width=30mm]{linalg.png}
\end{center}
\end{figure}
\end{itemize}

\hspace{-18pt}{\Large \underline{成績に関して}}

\underline{演習(後述)と期末試験(後述)で成績をつける予定です. } 内訳は未定です. 単位が欲しい方はこの二つに必ず出席するようにしてください. 

なお通常時の授業(演習や期末試験以外の授業)に出席点はございません. そのため授業への出席は任意となります. 


\medskip
\hspace{-18pt}{\Large \underline{1. 演習に関して}}

次の日時に演習の授業を行います. 
\begin{itemize}
  \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item 日時: 2024年6月5日と2024年7月17日 水曜3限(13:30-15:00)
\item 場所: 共C301
\item 演習内容: 配布したプリントの問題を解いて提出してください. なお協力して解いても構いません. 
\end{itemize}
\underline{以上は予定であるため, 変更の可能性があります.} もし変更する場合はホームページやCLEで連絡します. 
なお代理出席などの行為は不正行為とみなし, 加担した人全員の単位を不可にします.
欠席する場合はあらかじめmasataka@math.sci.osaka-u.ac.jpにご連絡いただければ幸いです.\footnote{その場合は欠席理由をきちんとお伝えください. ただし正当な理由以外での欠席は認められません. (成績に関わるからです.) よくわからない場合はとりあえずメールしてください.}

\newpage
\hspace{-18pt}{\Large \underline{2. 期末試験に関して}}

現時点での期末試験の予定は次のとおりです. 
\begin{itemize}
  \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item 日時: 2024年 7月24日 水曜3限(13:30-15:00) (予定)
\item 場所: 共C301
\item 持ち込みに関して: A4用紙4枚(裏表使用可)まで持ち込み可. 工夫を凝らしてA4用紙4枚に今までの内容をまとめてください.
\item 試験内容 : 授業・演習でやった範囲
\end{itemize}
\underline{以上は予定であるため, 変更の可能性があります.} もし変更する場合はホームページやCLEで連絡します. 

\medskip
\hspace{-18pt}{\Large \underline{まとめ}}
\begin{enumerate}
  \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm} 
\item \underline{単位が欲しい方は演習に必ず出席し, 期末試験で成績が取れるくらいの点を取ってください.} 
\item 単位を認定するくらいの成績が取れていない場合, 容赦無く不可を出します. 
\item 講義への出席は自由です. 授業資料・授業の板書をホームページにアップロードするので, 自分の好きな方法で線形代数への理解を進めてください.\footnote{理由としては「私は講義をするのが上手くない」のと「もっと効率的な理解の方法があると思う」からです. この授業内容を理解するのに$1.5 \times 14 = 21$時間も本当にかかるのかと思います. (というか今の私は90分じっと講義を受けるのが好きではないです.  14週に分けて講義を聞くのも好きではないです. ) そして世の中には私よりもわかりやすい授業する人もいるので, そちらで理解を進めても良いと思います. 学び方は自由であり, その方法を制限するのは好きではありません. (つまり出席を取るのも好きではないです).}
\end{enumerate}


\vspace{11pt}
\hspace{-18pt}{\Large \underline{その他}}
\begin{itemize}
  \setlength{\parskip}{0cm} % 段落間
  \setlength{\itemsep}{0cm} % 項目間
  \item 休講情報は授業ホームページ・KOANでお知らせいたします.
  %\item 休講予定: 2024年1月18日 (休講はほぼ確定) 2023年11月28日または2023年11月30日 (どちらか休講にするかも・未確定). \footnote{他にも授業が早く終われば休講にします.} 
    %\item 演習問題と授業内容が噛み合ってない可能性があります.
  \item 休講情報や資料の修正などをするので, こまめにホームページを確認してください.
  \item 教科書は「三宅敏恒著 線形代数学　初歩からジョルダン標準形へ」(培風館)を用いる. なお後期の茶碗谷先生の授業でも同じ教科書を用いる(と聞いています.)
   \item オフィスアワーを月曜16:00-17:00に設けています. この時間に私の研究室に来ても構いません(ただし来る場合は前もって連絡してくれると助かります.)
    %\item TAさんは演義の時間中に巡回しているので, 自由にご質問して構いません. 
    %\item $\pi$-base \url{https://topology.jdabbs.com}も活用してください. 
 \end{itemize}


\newpage 



\section{行列\cite[1章]{M}}
\subsection{行列と数ベクトル \cite[1.1節]{M}}
\subsubsection{行列の定義}
\begin{itemize}
\item $m \times n$個の数(実数または複素数) $a_{ij}$ ($i = 1, \ldots, m$, $j = 1, \ldots, n$)を
$$
\begin{bmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots\\
a_{m1}& a_{m2} & \cdots &a_{mn} \\
\end{bmatrix}
\textit{\,\,\ または\,\,\,}
\begin{pmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{m1}& a_{m2} & \cdots &a_{mn} \\
\end{pmatrix}
$$
のように並べたものを \underline{$m$行$n$列の行列}という.
\underline{ $m \times n$行列}, \underline{ $m \times n$型の行列}, \underline{ $(m, n)$行列}ということもある. 
\item 上の行列を$A$としたとき, $a_{ij}$を行列$A$の$(i,j)$成分という. 行列$A$を\underline{$[a_{ij}]_{m\times n}$や$(a_{ij})$}と略記することもある.
\item $\begin{pmatrix} a_{i1} & \cdots & a_{in}\end{pmatrix}$を\underline{$A$の行}といい, 上から第1行, 第2行, $\cdots$, 第$m$行という.
\item $\begin{pmatrix}a_{1j} \\ \vdots  \\ a_{mj}\end{pmatrix}$を\underline{$A$の列}といい, 上から第1列, 第2列, $\cdots$, 第$n$列という.
\item $1 \times n$行列$(a_{11} \cdots a_{1n})$を\underline{行ベクトル}と呼び, $m \times 1$行列$\begin{pmatrix}a_{11} \\ \vdots  \\ a_{m1}\end{pmatrix}$を\underline{列ベクトル}と呼ぶ. 数ベクトルといえば行ベクトルか列ベクトルをさす. (この授業や教科書での用語).
\end{itemize}

 \begin{exa}
 行列$A$を次で定める.
 $$
 A = 
 \begin{pmatrix}
 1 &2&5 \\
 3&10&4
 \end{pmatrix}
 $$
 \begin{itemize}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
 \item $A$は2行3列の行列($2 \times 3$行列).
 \item (1,2)成分は2, (2,1)成分は3, (2,3)成分は4である.
 \item 第2行は$\begin{pmatrix}3 & 10 & 4\end{pmatrix}$. 第3列は$\begin{pmatrix}5 \\ 4\end{pmatrix}$である.
 \end{itemize}
 \end{exa}
  \begin{exa}
 行列$A$を次で定める.
 $$
 A = 
 \begin{pmatrix}
 13 &2&5&3 \\
 1 &4&2&5 \\
  7&8&6&1 
 \end{pmatrix}
 $$
 \begin{itemize}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
 \item $A$は3行4列の行列($3 \times 4$行列).
 \item (1,1)成分は13, (2,4)成分は5, (3,2)成分は8である.
 \item 第2行は$\begin{pmatrix}1&4&2&5\end{pmatrix}$. 第3列は$\begin{pmatrix}5 \\2\\ 6\end{pmatrix}$である.
 \end{itemize}
 \end{exa}
 
 \begin{exa}行列$A = (2)$とすると, $A$は1行1列の行列($1 \times 1$行列)である.\end{exa}
  
%\begin{exa}行列$A$を次で定める.$$A = (3,5,2)$$$A$は1行3列の行列($1 \times 3$行列)である.\end{exa}

\subsubsection{特別な行列}
\begin{itemize}
\item  $
 \begin{pmatrix}
0 &0&0\\
0 &0&0
 \end{pmatrix}, 
  \begin{pmatrix}
0 &0\\
0 &0
 \end{pmatrix}, 
   \begin{pmatrix}
0 
 \end{pmatrix}, 
   \begin{pmatrix}
0 &0\\
0 &0 \\
0&0
 \end{pmatrix}
 $
 のように全ての成分が0の行列を\underline{\ruby{零}{ぜろ}行列}という.
 \item $n \times n$行列のことを\underline{$n$次正方行列}という.
 \item $n$次正方行列
 $$
 A =
 \begin{pmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{n1}& a_{n2} & \cdots &a_{nn} \\
\end{pmatrix}
 $$
 について, $a_{11}, a_{22}, \ldots, a_{nn}$を\underline{$A$の対角成分}という．
 \item 対角成分以外0の行列を\underline{対角行列}という. 例えば以下の行列は対角行列である:
  $$
 \begin{pmatrix}
5&0\\
0 &1
 \end{pmatrix}, 
  \begin{pmatrix}
3
 \end{pmatrix}, 
   \begin{pmatrix}
2&0 &0\\
0 &1 &0\\
0&0&5
 \end{pmatrix}
 $$
 \item 対角成分が全て1な$n$次対角行列を\underline{単位行列}と言い, $E_n$とかく. 例えば以下の行列は単位行列である:
   $$
   E_2 =
 \begin{pmatrix}
1&0\\
0 &1
 \end{pmatrix}, 
 E_1=
  \begin{pmatrix}
1
 \end{pmatrix}, 
 E_3=
   \begin{pmatrix}
1&0 &0\\
0 &1 &0\\
0&0&1
 \end{pmatrix}
 $$
 \item 行列$A$の行と列を入れ替えた行列を\underline{転置行列}と言い${}^{t}A$とかく.
\end{itemize}
\begin{exa}
 $
 A = 
 \begin{pmatrix}
 2 &5&8 \\
 3&2&1
 \end{pmatrix}
 \text{ についてその転置行列は}
{}^{t}A = 
 \begin{pmatrix}
 2 &3 \\
 5&2\\
 8&1
 \end{pmatrix}
  \text{であり, }
 $
 $
{}^{t}({}^{t}A) = 
 \begin{pmatrix}
 2 &5&8 \\
 3&2&1
 \end{pmatrix}
 =A
 $
 である.
 
  $
 A = 
 \begin{pmatrix}
 3 &1 \\
 2&4
 \end{pmatrix}
 \text{ についてその転置行列は}
{}^{t}A = 
 \begin{pmatrix}
 3 &2 \\
 1&4\\
 \end{pmatrix}
  \text{であり, }
 $
  $
{}^{t}({}^{t}A) = 
 \begin{pmatrix}
 3 &1 \\
 2&4
 \end{pmatrix}
 =A
 $
 である.
\end{exa}

 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}[転置行列の性質]
    \text{}
\begin{itemize}
  \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item $A$が$m\times n$行列なら${}^{t}A $は$n\times m$行列.
\item $A=[a_{ij}]_{m \times n}$とし, ${}^{t}A=[b_{ij}]_{n \times m}$とするとき, $b_{ij} =a_{ji}$.
\item ${}^{t}({}^{t}A) =A$.
\end{itemize}

  \end{prop}
 \end{tcolorbox}
 
 
 $$
 \delta_{ij} = 
 \begin{cases}
1 & \text{$i=j$のとき}\\
0 & \text{$i \neq j$のとき}
\end{cases}
  $$
 \text{を\underline{クロネッカーのデルタ}という.}
 \begin{exa}
 $\delta_{11}=\delta_{22}=1, \delta_{12}=\delta_{21}=0$である. $n$次正方行列$E_n$は$E_n = [\delta_{ij}]_{n\times n}$と略記できる.
 \end{exa}

\subsection{行列の演算 \cite[1.2節]{M}}
\subsubsection{行列の和と差}

 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[行列の和と差]
    \text{}
 
$m \times n$行列
$
A=\begin{pmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{m1}& a_{m2} & \cdots &a_{mn} \\
\end{pmatrix}
$, 
$
B=\begin{pmatrix}
b_{11}& b_{12} & \cdots &b_{1n} \\
b_{21}& b_{22} & \cdots &b_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
b_{m1}& b_{m2} & \cdots &b_{mn} \\
\end{pmatrix}
$
とする.

このとき行列の和$A+B$と差$A-B$を次で定める.
$$
A+B=
\begin{pmatrix}
a_{11}+b_{11}& a_{12}+b_{12}& \cdots &a_{1n} +b_{1n}\\
a_{21}+b_{21}& a_{22}+b_{22}& \cdots &a_{2n}+b_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{m1}+b_{m1}& a_{m2} +b_{m2}& \cdots &a_{mn} +b_{mn}\\
\end{pmatrix}.
$$
$$
A-B=
\begin{pmatrix}
a_{11}-b_{11}& a_{12}-b_{12}& \cdots &a_{1n} -b_{1n}\\
a_{21}-b_{21}& a_{22}-b_{22}& \cdots &a_{2n}-b_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{m1}-b_{m1}& a_{m2}-b_{m2}& \cdots &a_{mn}-b_{mn}\\
\end{pmatrix}.
$$
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
 $A = 
 \begin{pmatrix}
 1 &-2&8 \\
 2&5&-1
 \end{pmatrix}
 $, 
 $
 B = 
 \begin{pmatrix}
 -2&5&1 \\
 3&-1&2
 \end{pmatrix}
 $
 とする．
 
 このとき$
 A+B =
 \begin{pmatrix}
 -1 &3&9 \\
 5&4&1
 \end{pmatrix}
 $, 
 $
  A-B =
 \begin{pmatrix}
 3 &-7&7 \\
 -1&6&-3
 \end{pmatrix}
 $である.
 \end{exa}

\begin{exa}
 $A = 
 \begin{pmatrix}
 3&1 \\
 1&4
 \end{pmatrix}
 $, 
 $
 B = 
 \begin{pmatrix}
 2&7\\
 5&8
 \end{pmatrix}
 $
 とする．
 
 このとき$
 A+B =
 \begin{pmatrix}
 5&8 \\
6&12
 \end{pmatrix}
 $, 
 $
  A-B =
 \begin{pmatrix}
 1&-6 \\
 -4&-4
 \end{pmatrix}
 $である.
 \end{exa}
 
 \begin{exa}
 $A = 
 \begin{pmatrix}
 2&1 \\
 1&5
 \end{pmatrix}
 $,
$ 
 B = 
 \begin{pmatrix}
 1&1 &3 \\
 4&6 & 7
 \end{pmatrix}
 $
 とする．このとき$A+B$は型が違うため定義されない. 
 \end{exa}
 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}[行列の和と差の性質]
$A, B$を行列とする.
 \begin{itemize}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
 \item $A\pm B =B\pm A$.
  \item $A\pm O =A$ (ただし$O$は零行列).
  \item $(A+B)+C =A + (B+C)$.
  \item ${}^{t}(A+B) = {}^{t}A+ {}^{t}B$.
 \end{itemize}
  \end{prop}
 \end{tcolorbox}
 
 \subsubsection{行列のスカラー倍}
 
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[行列のスカラー倍]
    \text{}
    
 $m \times n$行列
 $
A=\begin{pmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{m1}& a_{m2} & \cdots &a_{mn} \\
\end{pmatrix}$
とし, $c$を数とする($c$をスカラーとも呼ぶ).

$A$の$c$倍$cA$を次で定める.
$$
cA=
\begin{pmatrix}
ca_{11}&c a_{12} & \cdots &ca_{1n} \\
ca_{21}& ca_{22} & \cdots &ca_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
ca_{m1}& ca_{m2} & \cdots &ca_{mn} \\
\end{pmatrix}.
$$
  \end{dfn}
 \end{tcolorbox}

\begin{exa}
 $A = 
 \begin{pmatrix}
 1 &-2&8 \\
 2&5&-1
 \end{pmatrix}
 $,
 $
 c =3
 $
 とする．
 このとき$
 cA =
 \begin{pmatrix}
 3 &-6&24 \\
 6&15&-3
 \end{pmatrix}
 $である.
 \end{exa}
 \begin{exa}
 $A = 
 \begin{pmatrix}
 2&1 \\
 4&3
 \end{pmatrix}
 $, 
 $
 c =-1
 $
 とする．
 このとき$
 cA =
 \begin{pmatrix}
 -2 &-1 \\
-4&-3
 \end{pmatrix}
 $である.
 \end{exa}
 
 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}[行列のスカラー倍の性質]
$A$を行列, $a,b$を数とする.
 \begin{itemize}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
 \item $0A =O$ (ただし$O$は零行列).
  \item $1A=A$. 
  \item $(-1)A$を$-A$と書くことにすると, $A + (-A) =O$.　
  \item $(ab) A = a(bA)$.
 \end{itemize}
  \end{prop}
 \end{tcolorbox}
 
 \subsubsection{行列の積}
 
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[行列の積]
    
 $m \times n$行列$A = [a_{ij}]_{m \times n}$と$n \times l$行列$B= [b_{jk}]_{n \times l}$とする．
このとき$A$と$B$の積$AB$は$m \times l$行列で, 次の式で定義される.

$$
AB = [c_{ik}]_{m \times l}\text{としたとき, }
c_{ik} = a_{i1}b_{1k} + a_{i2}b_{2k} + \cdots + a_{in}b_{nk} = \sum_{j=1}^{n} a_{ij}b_{jk}.
$$
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
 $ A=\begin{pmatrix} 1 &2 &3 \end{pmatrix}$, 
 $ 
 B = 
 \begin{pmatrix}
5 \\7\\2
 \end{pmatrix}
 $
 とする. 
 
 $A$は$1\times 3$行列で$B$は$3 \times 1$行列なので, 行列の積$AB$が$1 \times 1$行列として定義でき, 
 $$
 AB = \begin{pmatrix}1 &2&3  \end{pmatrix}
 \begin{pmatrix}
5 \\7\\2
 \end{pmatrix}
 = \begin{pmatrix}1\times 5 + 2 \times 7 + 3 \times 2  \end{pmatrix}= 
  \begin{pmatrix}5+14+6 \end{pmatrix}= \begin{pmatrix}25 \end{pmatrix}.
 $$
 
 \end{exa}
 
  \begin{exa}
 $ A= 
 \begin{pmatrix}
2 & 2\\
4 & 3
 \end{pmatrix}
 $, $
 B = 
 \begin{pmatrix}
5 \\1
 \end{pmatrix}
 $
 とする. 
 
 $A$は$2\times 2$行列で$B$は$2 \times 1$行列なので, 行列の積$AB$が$2 \times 1$行列として定義でき, 
 $$
 AB = 
 \begin{pmatrix}
2 & 2\\
4 & 3
 \end{pmatrix}
  \begin{pmatrix}
5 \\1
 \end{pmatrix}
 =  
 \begin{pmatrix}
2\times 5 + 2\times 1 \\
4 \times 5 + 3 \times 1
 \end{pmatrix}
 = 
  \begin{pmatrix}
12 \\
23
 \end{pmatrix}.
 $$
 
 \end{exa}
 
 \begin{exa}
 $ A= 
 \begin{pmatrix}
2 & 3\\
1 & 4
 \end{pmatrix}
 $, $
 B = 
 \begin{pmatrix}
5 & 2\\
2 & 3
 \end{pmatrix}
 $
 とする. 
 
 $A$は$2\times 2$行列で$B$は$2 \times 2$行列なので, 行列の積$AB$が$2 \times 2$行列として定義でき, 
 $$
 AB = 
 \begin{pmatrix}
2 & 3\\
1 & 4
 \end{pmatrix}
 \begin{pmatrix}
5 & 2\\
2 & 3
 \end{pmatrix}
 =  
 \begin{pmatrix}
2 \times 5 + 3 \times 2& 2 \times 2 + 3 \times 3\\
1 \times 5 + 4 \times 2 & 1\times 2 + 4 \times 3
 \end{pmatrix}
 = 
 \begin{pmatrix}
16 & 13\\
13 & 14
 \end{pmatrix}.
 $$
 
また$B$は$2\times 2$行列で$A$は$2 \times 2$行列なので, 行列の積$BA$が$2 \times 2$行列として定義でき, 
 $$
 BA = 
  \begin{pmatrix}
5 & 2\\
2 & 3
 \end{pmatrix}
  \begin{pmatrix}
2 & 3\\
1 & 4
 \end{pmatrix}
 =
  \begin{pmatrix}
12 & 23\\
7 & 18
 \end{pmatrix}.
 $$

よって\underline{行列の積に関して$AB=BA$とは限らない($AB \neq BA$となることがある).}
 \end{exa}
 
  \begin{exa}
 $ A= 
 \begin{pmatrix}
2 & 1&-3\\
1 & -5 & 2
 \end{pmatrix}
 $, $
 B = 
  \begin{pmatrix}
8 & 7&5 & 2
 \end{pmatrix}
 $
 とする. 
 
 $A$は$2 \times 3$行列で$B$は$1 \times 4$行列であるので, 行列の積$AB$は定義されない.
 \end{exa}
 
 \begin{ques}
 次の行列$A,B,C,D$のうち, 積が定義される全ての組み合わせを求め, その積を計算せよ.(この問題は授業で取り扱い, 答えを板書に書きます. )
 $$
  A=\begin{pmatrix}
 2 \\ 1\\-1
 \end{pmatrix} 
B= \begin{pmatrix}
 3 &2\\
 4&1\\
 0&1
 \end{pmatrix} 
 C=
  \begin{pmatrix}
 2 &0&1 
 \end{pmatrix}
 D= \begin{pmatrix}
 2&3\\
 -1&4
 \end{pmatrix}
 $$
 \end{ques}

 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}[行列の積の性質]
$A,B,C$を行列とする.
 \begin{itemize}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
 \item $AO =O = OA$ (ただし$O$は零行列).
  \item $AE_{n}=E_{n}A =A$ (ただし$E_n$は単位行列). 
  \item $(AB)C = A(BC)$.　
  \item ${}^{t}(AB) = {}^{t}B {}^{t}A$
 \end{itemize}
  \end{prop}
 \end{tcolorbox}
\begin{itemize}
\item $A$を$n$次正方行列とするとき$A^{m} = \underbrace{A \cdots A}_{m \text{ 個}}$とする
\item $A^{m}=O$となる行列を\underline{\ruby{冪}{べき}\ruby{零}{ぜろ}行列}という.
\end{itemize}

 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}[行列の演算の性質]
$A,B,C$を行列とし, $a,b$を数とする.
 \begin{itemize}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
 \item $a(AB)=(aA)B$. 
  \item $a(A+B)=aA + aB$. 
  \item $(a+b)A = aA + bA$.　
  \item $A(B+C) = AB + AC$.
  \item $(A+B)C = AC + BC$.
 \end{itemize}
  \end{prop}
 \end{tcolorbox}
 
 \begin{ques}
 次の行列の計算を行え.(この問題は授業で取り扱い, 答えを板書に書きます. )

 $$
 \begin{pmatrix}
 2 &3&-1 \\
 0&5&4\\
 -1&0&-2
 \end{pmatrix}
 \left\{
 \begin{pmatrix}
 0 &5&9 \\
 3&-2&8\\
 -1&8&1
 \end{pmatrix}
 - 2
  \begin{pmatrix}
 -1 &0&1 \\
 3&2&3\\
 -4&2&-1
 \end{pmatrix}
\right\}
 $$
  \end{ques}
 
\subsection{行列の分割 \cite[1.3節]{M}}
行列をいくつかの行列に分割して書くことがある.
例えば
$$
A = \begin{pmatrix}
A_{11}& A_{12} & \cdots &A_{1n}\\
A_{21}& A_{22} & \cdots &A_{2n}\\
\vdots& \vdots	&	\ddots   &	\vdots \\
A_{m1}& A_{m2} & \cdots &A_{mn} \\
\end{pmatrix}
$$
と言うふうに書くことである.
特に行ベクトル, 列ベクトルでこの表記をすることが多い.
\begin{exa}
$
A=
  \begin{pmatrix}
 1 &3&4&4 \\
 2&1&0&-1\\
 1&0&5&0
 \end{pmatrix}
 = 
   \begin{pmatrix}
\bm{a}_1&\bm{a}_2&\bm{a}_3&\bm{a}_4
 \end{pmatrix}
$.
ここで$\bm{a}_1, \bm{a}_2, \bm{a}_3, \bm{a}_4$は次で定義する. 
$$
\bm{a}_1 = 
  \begin{pmatrix}
 1 \\2 \\1
 \end{pmatrix},\quad
 \bm{a}_2 = 
  \begin{pmatrix}
 3 \\1 \\0
 \end{pmatrix},\quad
  \bm{a}_3 = 
  \begin{pmatrix}
 4 \\0 \\5
 \end{pmatrix},\quad
  \bm{a}_4 = 
  \begin{pmatrix}
 4 \\-1 \\0
 \end{pmatrix}.
$$
\end{exa}
\begin{exa}
$
A=
  \begin{pmatrix}
 1 &3&4&4 \\
 2&1&0&-1\\
 1&0&5&0
 \end{pmatrix}
 = 
   \begin{pmatrix}
\bm{b}_1\\ \bm{b}_2\\ \bm{b}_3
 \end{pmatrix}
$.
ここで$\bm{b}_1, \bm{b}_2, \bm{b}_3$は次で定義する. 
$$
\bm{b}_1 = 
  \begin{pmatrix}
 1 &3 &4&4
 \end{pmatrix},\quad
\bm{b}_2= 
  \begin{pmatrix}
 2&1 &0&-1
 \end{pmatrix},\quad
 \bm{b}_3 = 
  \begin{pmatrix}
 1 &0 &5&0
 \end{pmatrix}.
 $$
\end{exa}


\subsection{行列と連立1次方程式 \cite[1.4節]{M}}

\subsubsection{係数行列・拡大係数行列}

 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[係数行列, 拡大係数行列]
$m$個の式からなる$n$変数連立1次方程式
\begin{equation*}
%\label{equation}
\left\{ 
\begin{matrix}
a_{11}x_1&+& a_{12} x_2& +&\cdots &+&a_{1n}x_n &= &b_1 \\
a_{21}x_1&+& a_{22} x_2& +&\cdots &+&a_{2n}x_n &= &b_2 \\
\vdots		&& 	\vdots				 && 		& &\vdots&&\vdots	\\
a_{m1}x_1&+& a_{m2} x_2& +&\cdots &+&a_{mn}x_n &= &b_m \\
\end{matrix}
\right.
\text{に対して}
\end{equation*}
$$
A=\begin{pmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{m1}& a_{m2} & \cdots &a_{mn} \\
\end{pmatrix}
\bm{x} =\begin{pmatrix}
x_1\\x_2\\\vdots\\x_n
\end{pmatrix}
\bm{b} =\begin{pmatrix}
b_1\\b_2\\\vdots\\b_m
\end{pmatrix}
\text{とおく.}
$$
行列$A$を連立1次方程式の\underline{係数行列}といい, 
$$
[A : \bm{b}] = \begin{pmatrix}
a_{11}& a_{12} & \cdots &a_{1n} & b_1\\
a_{21}& a_{22} & \cdots &a_{2n} &b_2\\
\vdots& \vdots	&	\ddots   &	\vdots&\vdots \\
a_{m1}& a_{m2} & \cdots &a_{mn}&b_m \\
\end{pmatrix}
\text{を連立1次方程式の\underline{拡大係数行列}という.}
$$
  \end{dfn}
 \end{tcolorbox}
 これにより上の連立1次方程式は$A\bm{x}=\bm{b}$とかける.

 \begin{exa}
 連立1次方程式
 $
 \left\{ 
\begin{matrix}
2x&+&3y& = &7 \\
x&-&4y& = &9 \\
\end{matrix}
\right.
 $
 について, 係数行列は
 $A = 
 \begin{pmatrix}
 2 & 3 \\
 1 & -4
 \end{pmatrix}
 $
 で, 拡大係数行列は
 $[A : \bm{b}] = 
  \begin{pmatrix}
 2 & 3  &7\\
 1 & -4 &9
 \end{pmatrix}
 $
 である.
 \end{exa}
 
  \begin{exa}
 連立1次方程式
 $
 \left\{ 
\begin{matrix}
3x_1&-&2x_2& +& x_3 &+& 4x_4 &=& 7 \\
x_1 &  & 	   & -& 3x_3 &+& x_4 &=& 5 \\
2x_1&-& x_2& +& 9x_3 & & 	 &=& 0 \\
\end{matrix}
\right.
 $
 について, \\
 係数行列は
 $A = 
 \begin{pmatrix}
 3 & -2  & 1&4\\
 1 & 0   & -3&1\\
2 & -1  & 9&0\\
 \end{pmatrix}
 $
 で, 拡大係数行列は
 $[A : \bm{b}] = 
 \begin{pmatrix}
 3 & -2  & 1&4 & 7\\
 1 & 0   & -3&1 &5\\
2 & -1  & 9&0 & 0\\
 \end{pmatrix}
 $
 である.
 \end{exa}
 
 \subsubsection{数ベクトルの1次結合}
 
 
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[1次結合]
列ベクトル$\bm{a}_1, \ldots, \bm{a}_{m}$について, 
数$c_1, \ldots, c_n$を用いて
$$
c_1\bm{a}_1 + \cdots + c_m\bm{a}_{m}
$$
と表されるものを$\bm{a}_1, \ldots, \bm{a}_{m}$の1次結合と呼ぶ.
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
$\bm{x}=
   \begin{pmatrix}
2\\3
 \end{pmatrix}$
 を
 $\bm{a}_1 =   
  \begin{pmatrix}
3\\5
 \end{pmatrix}$と
  $\bm{a}_2=   
  \begin{pmatrix}
1\\3
 \end{pmatrix}$
 の1次結合で表すことを考える. 
 このときある数$c_1, c_2$があって
 $\bm{x}=c_1\bm{a}_1 + c_2\bm{a}_2$とかける.
 これを書き直すと
   $$
    \begin{pmatrix}
2\\3
 \end{pmatrix}
 =
 c_1  \begin{pmatrix}
3\\5
 \end{pmatrix}
 +
 c_2   \begin{pmatrix}
1\\3
 \end{pmatrix}
 $$
 となる. 
 これを解くと$c_1=\frac{3}{4}, c_2=-\frac{1}{4}$である.
 よって
 $$
    \begin{pmatrix}
2\\3
 \end{pmatrix}
 =
\frac{3}{4}  \begin{pmatrix}
3\\5
 \end{pmatrix}
-\frac{1}{4}
  \begin{pmatrix}
1\\3
 \end{pmatrix}
 $$
 と1次結合で表される.
 \end{exa}

 \begin{rem}

 $m$個の式からなる$n$変数連立1次方程式
\begin{equation*}
%\label{equation}
\left\{ 
\begin{matrix}
a_{11}x_1&+& a_{12} x_2& +&\cdots &+&a_{1n}x_n &= &b_1 \\
a_{21}x_1&+& a_{22} x_2& +&\cdots &+&a_{2n}x_n &= &b_2 \\
\vdots		&& 	\vdots				 && 		& &\vdots&&\vdots	\\
a_{m1}x_1&+& a_{m2} x_2& +&\cdots &+&a_{mn}x_n &= &b_m \\
\end{matrix}
\right.
\end{equation*}
に対し
$\bm{a}_{j} = 
\begin{pmatrix}
a_{1j}\\a_{2j}\\ \vdots \\a_{mj}
 \end{pmatrix}
$, $\bm{b} =\begin{pmatrix}
b_1\\b_2\\\vdots\\b_m
\end{pmatrix}$
とおけば上の連立1次方程式は
$
x_1\bm{a}_1 + \cdots x_n\bm{a}_n = \bm{b}
$ となる. 
 \end{rem}
 
 
 \section{連立1次方程式 \cite[2章]{M}}
 \subsection{基本変形 \cite[2.1節]{M}}
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[行列の基本変形]
 行列の次の3つの変形を基本変形という.
 \begin{enumerate}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
  \item 1つの行を何倍か($\neq 0$倍)する.
 \item 2つの行を入れ替える.
 \item1つの行に他の行の何倍かを加える.
 \end{enumerate}
  \end{dfn}
  
 \end{tcolorbox} 

拡大係数行列の基本変形を行うことで連立1次方程式が解ける.

\begin{exa}
 連立1次方程式
 $
 \left\{ 
\begin{matrix}
2x&+&3y& -&z &= &-3 \\
-x&+&2y& +&2z &= &1 \\
x&+&y& -&z &= &-2 \\
\end{matrix}
\right.
 $
 を考える. 
 これを拡大係数行列の基本変形と式変形で解いてみて, その対応を表すと下の通りとなる.\footnote{途中で現れる「$\maru{1}+\maru{3}\times(-2)$」は「行列の1行目に3行目の$(-2)$倍を加える」あるいは「1行目の式に3行目の式の$(-2)$倍を加える」を意味している(一応教科書に従った記法である).}

  %まずこれを式変形で解くと次のとおりである.\footnote{途中で現れる「$\maru{1}+\maru{3}\times(-2)$」は「1行目の式に3行目の式の(-2)倍を加える」を意味している(一応教科書に従った記法である).}
%これに対する拡大係数行列の基本変形は以下の通りである. \footnote{途中で現れる「$\maru{1} + \maru{3}\times(-2)$」は「行列の1行目に3行目の(-2)倍を加える」を意味している.}
 
  \begin{align*}
 & &\begin{pmatrix}
 2& 3  & -1&-3\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
 & \overset{\text{対応}}{\longleftrightarrow}& &\left\{ 
\begin{matrix}
2x&+&3y& -&z &= &-3 \\
-x&+&2y& +&2z &= &1 \\
x&+&y& -&z &= &-2 \\
\end{matrix}
\right.
 \\ %%
 &\overset{\text{$\maru{1} + \maru{3}\times(-2)$}}{\longrightarrow} 
 & \begin{pmatrix}
 0& 1  & 1&1\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\text{$\maru{1} + \maru{3}\times(-2)$}}{\longrightarrow} 
 & \left\{ 
\begin{matrix}
 & & y& + &z &= &1 \\
-x&+&2y& +&2z &= &1 \\
x&+&y& -&z &= &-2 \\
\end{matrix}
\right.
 \\ %%
  &\overset{\text{$\maru{2}+\maru{3}\times 1$ }}{\longrightarrow} 
 &\begin{pmatrix}
 0& 1  & 1&1\\
0 & 3& 1&-1\\
1& 1  & -1&-2\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\text{$\maru{2}+\maru{3}\times 1$ }}{\longrightarrow} 
 & \left\{ 
\begin{matrix}
 & & y& + &z &= &1\\
 & &3y& +& z &= &-1 \\
x&+&y& -&z &= &-2 \\
\end{matrix}
\right.
 \\ %%
   &\overset{\text{\maru{3}と\maru{1}を入れ替え}}{\longrightarrow} 
 &\begin{pmatrix}
1& 1  & -1&-2\\
0 & 3& 1&-1\\
 0& 1  & 1&1\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\text{\maru{3}と\maru{1}を入れ替え}}{\longrightarrow} 
 & \left\{ 
\begin{matrix}
x&+&y& -&z &= &-2 \\
 & &3y& +& z &= &-1 \\
 & & y& + &z &= &1\\
\end{matrix}
\right.
 \\ %%
    &\overset{\text{\maru{2}と\maru{3}を入れ替え}}{\longrightarrow} 
 &\begin{pmatrix}
1& 1  & -1&-2\\
 0& 1  & 1&1\\
 0 & 3& 1&-1\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\text{\maru{2}と\maru{3}を入れ替え}}{\longrightarrow} 
 & \left\{ 
\begin{matrix}
x&+&y& -&z &= &-2 \\
 & & y& + &z &= &1\\
  & &3y& +& z &= &-1 \\
\end{matrix}
\right.
 \\ %%
    &\overset{\maru{1}  + \maru{2}\times(-1)}{\underset{\maru{3} +  \maru{2}\times(-3)}{\longrightarrow}}
 &\begin{pmatrix}
1& 0  & -2&-3\\
 0& 1  & 1&1\\
 0 & 0& -2&-4\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\maru{1}  + \maru{2}\times(-1)}{\underset{\maru{3} +  \maru{2}\times(-3)}{\longrightarrow}}
 & \left\{ 
\begin{matrix}
x& & & -&2z &= &-3 \\
 & & y& + &z &= &1\\
  & & & -& 2z &= &-4 \\
\end{matrix}
\right.
 \\ %%
    &\overset{\text{\maru{3}$\times (-\frac{1}{2})$}}{\longrightarrow}
 &\begin{pmatrix}
1& 0  & -2&-3\\
 0& 1  & 1&1\\
 0 & 0& 1&2\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\text{\maru{3}$\times (-\frac{1}{2})$}}{\longrightarrow}
 & \left\{ 
\begin{matrix}
x& & & -&2z &= &-3 \\
 & & y& + &z &= &1\\
  & & &  & z &= &2 \\
\end{matrix}
\right.
 \\ %%
&\overset{\maru{1} + \maru{3}\times 2}{\underset{\maru{2} + \maru{3}\times(-1) }{\longrightarrow}}
 &\begin{pmatrix}
1& 0  & 0&1\\
 0& 1  & 0&-1\\
 0 & 0& 1&2\\
 \end{pmatrix}
&\overset{\text{対応}}{\longleftrightarrow} 
&\overset{\maru{1} + \maru{3}\times 2}{\underset{\maru{2} + \maru{3}\times(-1) }{\longrightarrow}}
 & \left\{ 
\begin{matrix}
x& & &  &  &= &1 \\
 & & y&   & &= &-1\\
  & & &  & z &= &2 \\
\end{matrix}
\right.
 \\ %%
 \end{align*}
 以上より解は$x=1, y=-1, z=2$である.
\end{exa}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 \begin{comment}
 ボツネタ
 
  
 %\overset{\text{$ \maru{1}  + \maru{2}\times(-1)$ と$\maru{3} +  \maru{2}\times(-3) $}}{\longrightarrow} 
 $\overset{\maru{1}  + \maru{2}\times(-1)}{\underset{\maru{3} +  \maru{2}\times(-3)}{\longrightarrow}}$
 
 \begin{align*}
 &\begin{pmatrix}
 2& 3  & -1&-3\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
\overset{\text{$\maru{1} + \maru{3}\times(-2)$}}{\longrightarrow} 
 \begin{pmatrix}
 0& 1  & 1&1\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
\overset{\text{$\maru{2}+\maru{3}\times 1$ }}{\longrightarrow} 
 \begin{pmatrix}
 0& 1  & 1&1\\
0 & 3& 1&-1\\
1& 1  & -1&-2\\
 \end{pmatrix}
 \\
 &\overset{\text{\maru{3}と\maru{1}を入れ替え}}{\longrightarrow} 
\begin{pmatrix}
1& 1  & -1&-2\\
0 & 3& 1&-1\\
 0& 1  & 1&1\\
 \end{pmatrix}
  \overset{\text{\maru{2}と\maru{3}を入れ替え}}{\longrightarrow} 
\begin{pmatrix}
1& 1  & -1&-2\\
 0& 1  & 1&1\\
 0 & 3& 1&-1\\
 \end{pmatrix}
 \\
 &  \overset{\text{
$ \maru{1}  + \maru{2}\times(-1)$ と$\maru{3} +  \maru{2}\times(-3) $
 }}{\longrightarrow} 
 \begin{pmatrix}
1& 0  & -2&-3\\
 0& 1  & 1&1\\
 0 & 0& -2&-4\\
 \end{pmatrix}
   \overset{\text{\maru{3}$\times (-\frac{1}{2})$}}{\longrightarrow}
\begin{pmatrix}
1& 0  & -2&-3\\
 0& 1  & 1&1\\
 0 & 0& 1&2\\
 \end{pmatrix} 
 \\
 &\overset{\text{
$\maru{1} + \maru{3}\times 2 $ と $\maru{2} + \maru{3}\times(-1) $
  }}{\longrightarrow} 
  \begin{pmatrix}
1& 0  & 0&-1\\
 0& 1  & 0&-1\\
 0 & 0& 1&2\\
 \end{pmatrix} 
\end{align*}
 
 
 
 
 \begin{align*}
&\begin{pmatrix}
 2& 3  & -1&-3\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
 &\text{対応}&
  \left\{ 
\begin{matrix}
2x&+&3y& -&z &= &-3 \\
-x&+&2y& +&2z &= &1 \\
x&+&y& -&z &= &-2 \\
\end{matrix}
\right.
 \\
&\overset{\text{$\maru{1} + \maru{3}\times(-2)$}}{\longrightarrow} 
 \begin{pmatrix}
 0& 1  & 1&1\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
 \\
&\overset{\text{$\maru{2}+\maru{3}\times 1$ }}{\longrightarrow} 
 \begin{pmatrix}
 0& 1  & 1&1\\
0 & 3& 1&-1\\
1& 1  & -1&-2\\
 \end{pmatrix}
 \\
 &\overset{\text{\maru{3}と\maru{1}を入れ替え}}{\longrightarrow} 
\begin{pmatrix}
1& 1  & -1&-2\\
0 & 3& 1&-1\\
 0& 1  & 1&1\\
 \end{pmatrix}
  \overset{\text{\maru{2}と\maru{3}を入れ替え}}{\longrightarrow} 
\begin{pmatrix}
1& 1  & -1&-2\\
 0& 1  & 1&1\\
 0 & 3& 1&-1\\
 \end{pmatrix}
 \\
 &  \overset{\text{
$ \maru{1}  + \maru{2}\times(-1)$ と$\maru{3} +  \maru{2}\times(-3) $
 }}{\longrightarrow} 
 \begin{pmatrix}
1& 0  & -2&-3\\
 0& 1  & 1&1\\
 0 & 0& -2&-4\\
 \end{pmatrix}
   \overset{\text{\maru{3}$\times (-\frac{1}{2})$}}{\longrightarrow}
\begin{pmatrix}
1& 0  & -2&-3\\
 0& 1  & 1&1\\
 0 & 0& 1&2\\
 \end{pmatrix} 
 \\
 &\overset{\text{
$\maru{1} + \maru{3}\times 2 $ と $\maru{2} + \maru{3}\times(-1) $
  }}{\longrightarrow} 
  \begin{pmatrix}
1& 0  & 0&-1\\
 0& 1  & 0&-1\\
 0 & 0& 1&2\\
 \end{pmatrix} 
\end{align*}

\begin{align*}
 \begin{pmatrix}
 2& 3  & -1&-3\\
-1 & 2 & 2&1\\
1& 1  & -1&-2\\
 \end{pmatrix}
&\overset{\text{対応}}{\leftrightarrow} 
 \left\{ 
\begin{matrix}
2x&+&3y& -&z &= &-3 \\
-x&+&2y& +&2z &= &1 \\
x&+&y& -&z &= &-2 \\
\end{matrix}
\right.
\\
\end{align*}
  \end{comment}

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 \begin{rem}
 今回わかりやすさのため 基本変形に
 $\overset{\text{
$ \maru{1}  + \maru{2}\times(-1)$ と$\maru{3} +  \maru{2}\times(-3) $
 }}{\longrightarrow} 
$
と説明を書いたが, \underline{試験などではこのことを書かなくて良い. }
また基本変形をする際に$=$を使う人がいるが, $\to$を用いた方が良い.
 \end{rem}

\begin{ques}
連立1次方程式
 $
 \left\{ 
\begin{matrix}
x_1&+&x_2& -&x_3 &= & 1\\
2x_1&+&x_2& +&3x_3&= &4 \\
-x_1&+&2x_2& -&4x_3 &= &-2 \\
\end{matrix}
\right.
 $
 を解け.(この問題は授業で取り扱い, 答えを板書に書きます. )
 \end{ques}


\subsection{簡約な行列 \cite[2.2節]{M}}


\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[主成分]
  行列において, それぞれの行の最初に現れる0でない成分を主成分という.
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
 $$
  \begin{pmatrix}
\xr{1} & 2&3\\
0 & 0&\xr{5}\\
0 & 0&0\\
0 & \xr{3}&0\\ 
 \end{pmatrix}
 $$
 の主成分は赤色のものである. 
 \end{exa}


 
 
 
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[簡約行列 教科書版]
  行列$A$が次の4つの条件を満たすとき, $A$を\underline{簡約な行列}という.
  \begin{enumerate}
    \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item 行ベクトルのうちに零ベクトル(全ての成分が0である行)があれば, それは零ベクトルでないものよりも下にある.
\item 零ベクトルでない行ベクトルの主成分は1である.
\item 第$i$行の主成分を$a_{ij_{i}}$とすると, $j_1<j_2<j_3<\cdots$となる. すなわち各行の主成分は下の行ほど右にある.
\item 各行の主成分を含む列の他の成分は全て0である. すなわち第$i$行の主成分が$a_{ij_{i}}$であるならば, 第$j_i$列の$a_{ij_{i}}$以外の成分は全て0である.
  \end{enumerate}
  \end{dfn}
 \end{tcolorbox}
 
 ちょっとわかりにくいので厳密さを落として要約すると次の通りである. 
 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[簡約行列の要約版]
  行列$A$が次の4つの条件を満たすとき, $A$を\underline{簡約行列}という.
  \begin{enumerate}
  	\setlength{\parskip}{0cm}
  	\setlength{\itemsep}{0pt} 
\item 全ての成分が0である行は0以外の値を含む行より下側にある. 
\item 主成分は全て1.
\item 右側の列に行くほど, 主成分は下側にある.
\item 主成分を持つ列は, その主成分を除く全てが0.
  \end{enumerate}
  \end{dfn}
 \end{tcolorbox}
 
 
 
 
 \begin{exa}
以下の行列は全て簡約な行列である.
$$
 \begin{pmatrix}
 0& 1& 3  & 0&2\\
 0& 0& 0  & 1&1\\
 0& 0& 0 & 0&0\\
 \end{pmatrix}
  \begin{pmatrix}
 1& 0& 1  & 4&0&-1\\
 0& 1& 7 & -4&0&1\\
 0& 0& 0 & 0&1&3\\
 \end{pmatrix}
   \begin{pmatrix}
 0& 0& 0  & 1&6&0&3&0\\
 0& 0& 0 & 0&0&1&2&0\\
 0& 0& 0 & 0&0&0&0&0 \\
 \end{pmatrix}
$$
\end{exa}
 \begin{exa}
 次に簡約ではない行列の例を理由とともに挙げる.
 \begin{itemize}
\item 
$ 
\begin{pmatrix}
 1& 0& 1  & 1&0\\
 0& 0& 0  & 0&0\\
 0& 0& 0 & 0&1\\
 \end{pmatrix} 
 $
 は1番目の条件が満たされていないので簡約ではない.
 \item 
$ 
\begin{pmatrix}
 1& 0& 1  & 1&0\\
 0& 0& 0  & 0&3\\
 \end{pmatrix} 
 $
 は2番目の条件が満たされていないので簡約ではない.
 \item 
$ 
\begin{pmatrix}
 0& 0& 1  & 0&0\\
 1& 0& 0  & 0&0\\
 \end{pmatrix} 
 $
 は3番目の条件が満たされていないので簡約ではない.
 \item 
$ 
\begin{pmatrix}
 1& 0& 1  & 1&0\\
 1& 0& 0  & 0&1\\
 \end{pmatrix} 
 $
 は4番目の条件が満たされていないので簡約ではない.
 \end{itemize}
\end{exa}

 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}[簡約化]
    任意の行列$A$は基本変形を繰り返して簡約行列$B$を得ることができる. またそのような簡約行列$B$は一意に定まる.
 このように基本変形を繰り返して簡約行列を得ることを\underline{$A$を簡約化する}といい, 得られた簡約行列$B$を\underline{$A$の簡約化}という.
   \end{thm}
 \end{tcolorbox}
 
 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}[階数(ランク)]
$A$を行列とし, $B$を$A$の簡約化とする.
${\rm rank}(A)$を$B$の零ベクトルでない行の個数とし\underline{$A$の階数(ランク)}と呼ぶ.
   \end{dfn}
 \end{tcolorbox}
 
 
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}
   $A$を$m\times n$行列とする. 
   このとき${\rm rank}(A)$は簡約化の仕方によらずに定まる数であり, ${\rm rank}(A) \le \min(m,n)$である.
   \end{prop}
 \end{tcolorbox}
 
 
\begin{exa}
$A=
 \begin{pmatrix}
 0& 1& 3  & 0&2\\
 0& 0& 0  & 1&1\\
 0& 0& 0 & 0&0\\
 \end{pmatrix}
 $
 とすると, これは簡約な行列であり零ベクトルでない行の個数は2個である. よって${\rm rank}(A)=2$.
 
 $B= \begin{pmatrix}
 1& 0& 1  & 4&0&-1\\
 0& 1& 7 & -4&0&1\\
 0& 0& 0 & 0&1&3\\
 \end{pmatrix}
 $ とすると, これは簡約な行列であり零ベクトルでない行の個数は3個である. よって${\rm rank}(B)=3$.
\end{exa}

\begin{exa}
$
 \begin{pmatrix}
 1& 2& -3  \\
 1& 1& 1  \\
 \end{pmatrix}
 $
 を基本変形で簡約化すると次のとおりである.\footnote{第4回授業資料と同じで「$\maru{2} + \maru{1}\times(-1)$」は「行列の2行目に1行目の(-1)倍を加える」を意味している.}
 \begin{align*}
  \begin{pmatrix}
 1& 2& -3  \\
 1& 1& 1  \\
 \end{pmatrix}
 \overset{\text{$\maru{2} + \maru{1}\times(-1)$}}{\longrightarrow} 
   \begin{pmatrix}
 1& 2& -3  \\
 0& -1& 4  \\
 \end{pmatrix}
 \overset{\text{$\maru{2} \times(-1)$}}{\longrightarrow} 
   \begin{pmatrix}
 1& 2& -3  \\
 0& 1& -4  \\
 \end{pmatrix}
  \overset{\maru{1} + \maru{2}\times(-1)}{\longrightarrow} 
   \begin{pmatrix}
 1& 0& 5  \\
 0& 1& -4  \\
 \end{pmatrix}.
  \end{align*}
  よってこの行列の階数(ランク)は2である.
\end{exa}

\begin{exa}
$
 \begin{pmatrix}
 1& 0& 2  &1\\
 2& 1& 1  &0\\
 0& 1& 1  &0\\
 \end{pmatrix}
 $
 を基本変形で簡約化すると次のとおりである.
 
 \begin{align*}
 &\begin{pmatrix}
 1& 0& 2  &1\\
 2& 1& 1  &0\\
 0& 1& 1  &0\\
 \end{pmatrix}
 \overset{\maru{2} + \maru{1}\times(-2)}{\longrightarrow} 
\begin{pmatrix}
 1& 0& 2  &1\\
 0& 1& -3 &-2\\
 0& 1& 1  &0\\
 \end{pmatrix}
\overset{\maru{3} + \maru{2}\times(-1)}{\longrightarrow} 
\begin{pmatrix}
 1& 0& 2  &1\\
 0& 1& -3 &-2\\
 0& 0& 4  &2\\
 \end{pmatrix}
 \\ %%
 & \overset{\maru{3}\times \frac{1}{2}}{\longrightarrow} 
\begin{pmatrix}
 1& 0& 2  &1\\
 0& 1& -3 &-2\\
 0& 0& 2  &1\\
 \end{pmatrix} 
 \overset{\maru{1} + \maru{3}\times (-1)}{\underset{\maru{2} + \maru{3}\times \frac{3}{2}}{\longrightarrow}}
 \begin{pmatrix}
 1& 0& 0  &0\\
 0& 1& 0 &-\frac{1}{2}\\
 0& 0& 2  &1\\
 \end{pmatrix} 
 \overset{\maru{3}\times \frac{1}{2}}{\longrightarrow} 
  \begin{pmatrix}
 1& 0& 0  &0\\
 0& 1& 0 &-\frac{1}{2}\\
 0& 0& 1 &\frac{1}{2}\\
 \end{pmatrix}.
 \end{align*}
   よってこの行列の階数(ランク)は3である.
 \end{exa}
 
\begin{ques}
$
 \begin{pmatrix}
 1& 0& -1  & 0&-2\\
 0& 1& 1  & 0&1\\
  -1& 0& 1 & 1&1\\
 2& 1& -1 & 0&-3\\
 \end{pmatrix}
 $
 を簡約化し, その階数を求めよ.(この問題は授業で取り扱い, 答えを板書に書きます. )
\end{ques}


\subsection{連立1次方程式をとく \cite[2.3節]{M}}
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
連立1次方程式$A\bm{x} =\bm{b}$が解を持つ
$\Leftrightarrow$ ${\rm rank}([A:\bm{b}]) = {\rm rank}(A)$.
  \end{thm}
 \end{tcolorbox}
%連立1次方程式$A\bm{x} =\bm{b}$を解くためには, 拡大係数行列$[A:\bm{b}]$を簡約化してあげれば良い(この解き方を掃き出し法・ガウスの消去法とも言います). 

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
連立1次方程式$A\bm{x} =\bm{b}$の解きかた(掃き出し法・ガウスの消去法).
 \begin{enumerate}
 \item[手順1.] 連立方程式$A\bm{x} =\bm{b}$から拡大係数行列$[A:\bm{b}]$を作る.
 \item[手順2.] 拡大係数行列$[A:\bm{b}]$を基本変形で簡約化する.
 \item[手順3.] その簡約化された行列のデータから連立方程式を書き下し, 一般解を求める.
 \end{enumerate}
 \end{tcolorbox}
 
\begin{exa}
連立1次方程式
 $
 \left\{ 
\begin{matrix}
x_1&+&2x_2& = &2 \\
x_1&+&4x_2& = &4\\
\end{matrix}
\right.
 $
 を解け.
 
 (解). 連立方程式の拡大係数行列は
 $[A:\bm{b}]=
  \begin{pmatrix}
 1& 2& 2  \\
 2& 4& 4  \\
 \end{pmatrix}
 $
 である. これを簡約化すると
 $
  \begin{pmatrix}
 1& 2& 2  \\
 0& 0& 0  \\
 \end{pmatrix} 
 $
 となる. よってこれより
 $
  \left\{ 
\begin{matrix}
x_1&+&2x_2& = &2 \\
0x_1&+&0x_2& = &0\\
\end{matrix}
\right.
$
である. 

以上より解は
$
 \left\{ 
\begin{matrix}
x_1&=& 2 -2c_2\\
x_2 &=& c_2\\
\end{matrix}
\text{\,\, ($c_2$は任意定数)}
\right.
$
となる. 

解の書き方として
$
\begin{pmatrix}
x_1\\
x_2 \\
\end{pmatrix}
=
\begin{pmatrix}
2\\
0 \\
\end{pmatrix}
+t 
\begin{pmatrix}
-2\\
1 \\
\end{pmatrix}
(t \in \R)
$
と書くこともある.
\end{exa}

\begin{exa}
連立1次方程式
 $
 \left\{ 
\begin{matrix}
x_1&+&2x_2& = &2 \\
x_1&+&4x_2& = &5\\
\end{matrix}
\right.
 $
 を解け.
 
 (解). 連立方程式の拡大係数行列は
 $[A:\bm{b}]=
  \begin{pmatrix}
 1& 2& 2  \\
 2& 4& 5  \\
 \end{pmatrix}
 $
 である. 
 これを簡約化すると
 $
  \begin{pmatrix}
 1& 2& 0  \\
 0& 0& 1 \\
 \end{pmatrix} 
 $
 となる. よってこれより
 $
  \left\{ 
\begin{matrix}
x_1&+&2x_2& = &0 \\
0x_1&+&0x_2& = &1\\
\end{matrix}
\right.
$
である. 以上より解は存在しない.
\end{exa}

\begin{exa}
連立1次方程式
 $
 \left\{ 
\begin{matrix}
x_1&-&2x_2&   &		&+&3x_4& &	&= 2 \\
x_1&-&2x_2& + &x_3&+&2x_4&+&x_5&= 2 \\
2x_1&-&4x_2& + &x_3&+&5x_4&+&2x_5&= 5 \\
\end{matrix}
\right.
 $
 を解け.
 
 (解). 拡大係数行列は 
 $[A:\bm{b}]=
  \begin{pmatrix}
 1& -2& 0 & 3& 0& 2   \\
  1& -2& 1& 2& 1& 2   \\
 2& -4& 1 & 5& 2& 5   \\
 \end{pmatrix}
 $
 である. これを基本変形で簡約化すると
 $
  \begin{pmatrix}
 1& -2& 0 & 3& 0& 2   \\
 0& 0& 1& -1& 0& 1   \\
 0& 0& 0 & 0& 1& 1   \\
 \end{pmatrix}
 $
 となる.
 これをもう一回式に書き下すと
 $$
\left \{
 \begin{matrix}
x_1&-&2x_2&   &		&+&3x_4& &	&= 2 \\
      & &		&   &x_3       &- & x_4& &       &= -1 \\
      & & &   &    & &		& & x_5&= 1 \\
\end{matrix}
\right.
\text{である.}
 $$
 
以上より解は
$
 \left\{ 
\begin{matrix}
x_1&=& 2 +2c_2 -3c_4\\
x_2&=&c_2 \\
x_3&=& -1 + c_4\\
x_4&=&c_4 \\
x_5&=& 1\\
\end{matrix}
\text{\,\, ($c_2, c_4$は任意定数)}
\right.
$
となる. 
 
解の書き方として
$
\begin{pmatrix}
x_1\\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
\end{pmatrix}
=
\begin{pmatrix}
2\\
0 \\
-1 \\
0\\
1 \\
\end{pmatrix}
+ s
\begin{pmatrix}
2\\
1\\
0\\
0\\
0 \\
\end{pmatrix}
+ t
\begin{pmatrix}
-3\\
0\\
1\\
1\\
0 \\
\end{pmatrix}
(s, t \in \R)
$
と書くこともある.
 \end{exa}

\begin{ques}

連立1次方程式
 $
 \left\{ 
\begin{matrix}
x_1& &         &  +& 2x_3&- &x_4&+ & 2x_5&= 3 \\
2x_1&+&x_2& + &3x_3&-&x_4&-&x_5&= -1 \\
-x_1&+&3x_2& - &5x_3&+&4x_4&+&x_5&= -6 \\
\end{matrix}
\right.
 $
 を解け.(この問題は授業で取り扱い, 答えを板書に書きます. )
 \end{ques}
 
\begin{rema}
実際に連立1次方程式をプログラミングで解くときも, 掃き出し法・ガウスの消去法によって解きます. 実際にc++で書いたソースコードを以下のホームページで見ることができます.\footnote{簡約化の証明をする際にもこのホームページを参考にさせていただきました.}
\begin{itemize}
\item Gauss-Jordan の掃き出し法と、連立1次方程式の解き方 \\
 \texttt{https://drken1215.hatenablog.com/entry/2019/03/20/202800}
\end{itemize}
\end{rema}


\subsection{正則行列\cite[2.4節]{M}}
\subsubsection{逆行列}
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
$A$を$n$次正方行列とする.
 ある行列$B$があって
 $$
 AB =BA =E_{n} %\text{(\,\,\,ただし$E_n$は単位行列)}
 $$
 となるとき\underline{$B$を$A$の逆行列}といい$B=A^{-1}$とかく.
 
 行列$A$が逆行列$A^{-1}$を持つとき, $A$は\underline{正則行列}という(\underline{$A$は正則である}ともいう).
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
 $A=
  \begin{pmatrix}
 1& -5  \\
 0& 1  \\
 \end{pmatrix} 
 $
 の逆行列は
  $A^{-1}=
  \begin{pmatrix}
 1& 5  \\
 0& 1  \\
 \end{pmatrix} 
 $
 である. \\ 
 実際
  $
  \begin{pmatrix}
 1& -5  \\
 0& 1  \\
 \end{pmatrix} 
  \begin{pmatrix}
 1& 5  \\
 0& 1  \\
 \end{pmatrix} 
=
  \begin{pmatrix}
 1& 5  \\
 0& 1  \\
 \end{pmatrix} 
   \begin{pmatrix}
 1& -5  \\
 0& 1  \\
 \end{pmatrix} 
 =
   \begin{pmatrix}
 1& 0 \\
 0& 1  \\
 \end{pmatrix} 
 $
 である.
 特に$A$は正則行列である. 
 \end{exa}

 \begin{exa}
2次正方行列
 $A=
  \begin{pmatrix}
 a& b  \\
 c& d  \\
 \end{pmatrix} 
 $
 について
  $ad-bc \neq 0$ならば, $A$は逆行列を持ち
 $$
 A^{-1} =   
 \frac{1}{ad-bc}
 \begin{pmatrix}
 d& -b  \\
 -c& a  \\
 \end{pmatrix} 
 \text{\,\,\,である.}
 $$
  特に$A$は正則行列である. 
 \end{exa}
 
  \begin{exa}
  $
   A=\begin{pmatrix}
 0& 1 \\
 0& 1  \\
 \end{pmatrix} 
 $
 は逆行列を持たない. 特に$A$は正則行列ではない.
  \end{exa}
  
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
    $A$を$n$次正方行列とするとき, 以下は同値.
\begin{enumerate}
  \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item $\rank (A) =n$
\item $A$の簡約化は$E_n$である.
\item 任意の$n$次列ベクトル$\bm{b}$について, $A \bm{x}=\bm{b}$はただ一つの解をもつ.
\item $A \bm{x}=0$の解は$\bm{x}=0$に限る.
\item $A$は正則行列.
\item $A$の行列式$\det(A)$は0ではない(行列式に関しては\ref{sec:det}章にて扱う).
\end{enumerate}
  \end{thm}
 \end{tcolorbox}
 
 \subsubsection{掃き出し法を使った逆行列の求め方}
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
    $A$を$n$次正方行列とし, $n \times 2n$行列$[A : E_n]$の簡約化が$[E_n : B]$となるとする.
    このとき$A$は正則行列で, $B$は$A$の逆行列である.
  \end{thm}
 \end{tcolorbox}
 この定理により掃き出し法を用いて逆行列を得ることができる.
 
 \begin{exa}
 $
  A=\begin{pmatrix}
 1& 2&1 \\
 2& 3 & 1 \\
 1& 2 &  2 \\
 \end{pmatrix} 
 $
 の逆行列を求めよ.
 
 (解).
 $[A:E_3] = 
 \begin{pmatrix}
 1& 2&1  &1& 0&0 \\
 2& 3 & 1 &0& 1&0 \\
 1& 2 &  2 &0& 0&1 \\
 \end{pmatrix} 
 $
 を基本変形を用いて簡約化すると, \\
 $
 \begin{pmatrix}
 1& 0&0  &-4& 2&1 \\
 0& 1 & 0 &3& -1&-1 \\
 0& 0&  1 &-1& 0&1 \\
 \end{pmatrix} 
 $
 となる. よって$A$の逆行列は
 $
 \begin{pmatrix}
-4& 2&1 \\
3& -1&-1\\
1& 0&1 \\
 \end{pmatrix} 
 $
 である.
 \end{exa}


\begin{ques}
$
\begin{pmatrix}
 2& -1& 0\\
 2& -1 & -1 \\
 1& 0 &  -1 \\
 \end{pmatrix} 
 $の逆行列を求めよ. (この問題は授業で取り扱い, 答えを板書に書きます.)
\end{ques}


\section{行列式 \cite[3章]{M}}
\label{sec:det}


\subsection{置換 \cite[3.1節]{M}}

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
    \text{}
    \begin{itemize}
\item $\{ 1, \ldots, n\}$から$\{ 1, \ldots, n\}$への1対1写像を\underline{置換}と言い$\sigma$で表す．
つまり置換$\sigma$とは$k_1, \ldots, k_n$を1から$n$の並び替えとして, 
1を$k_1$に, 2を$k_2$に, $\cdots$, $n$を$k_n$にと変化させる規則のことである.
\item 上の置換$\sigma$を
$$
\sigma =
  \begin{pmatrix}
 1& 2  &\cdots &n\\
 k_1& k_2  &\cdots &k_n\\
 \end{pmatrix} 
$$
とかき, $\sigma(1) =k_1, \sigma(2) =k_2, \ldots, \sigma(n) =k_n$とする.
    \end{itemize}
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
 置換$\sigma$を
$
\sigma =
  \begin{pmatrix}
 1& 2  &3 &4\\
 3& 1  &4 &2\\
 \end{pmatrix} 
$
とする. 
これは「1を$3$に, 2を$1$に, 3を4に, 4を$2$にと変化させる規則」である.
 $\sigma(1) =3, \sigma(2) =1, \sigma(3) =4,  \sigma(4) =2$である.
 \end{exa}
 
 \begin{exa}
 置換$\sigma$を
$
\sigma =
  \begin{pmatrix}
 1& 2  &3 \\
 2& 1  &3 \\
 \end{pmatrix} 
$
とする. 
これは「1を$2$に, 2を$1$に, 3を3にと変化させる規則」である.
 $\sigma(1) =2, \sigma(2) =1, \sigma(3) =3$である.
 
 この置換は3に関しては何も変化させていないので
 $
\sigma =
  \begin{pmatrix}
 1& 2   \\
 2& 1   \\
 \end{pmatrix} 
$
ともかく.
 \end{exa}

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
置換$\sigma, \tau$について, その積$\sigma \tau$を
$\sigma(\tau(i))$で定める.
  \end{dfn}
 \end{tcolorbox}
 
\begin{exa}
 置換$\sigma, \tau$を
$
\sigma =
  \begin{pmatrix}
 1& 2  &3 & 4 \\
 4& 3  &1  &2 \\
 \end{pmatrix} 
\tau=
  \begin{pmatrix}
 1& 2  &3 & 4 \\
 2& 3  &4  &1 \\
 \end{pmatrix} 
 $
とすると, 
$$
  \begin{matrix}
 \sigma (\tau (1)) &= &  \sigma (2)  & = & 3  \\
 \sigma (\tau (2)) &= &  \sigma (3)  & = & 1 \\
 \sigma (\tau (3)) &= &  \sigma (4)  & = & 2  \\
 \sigma (\tau (4)) &= &  \sigma (1)  & = & 4  \\
 \end{matrix} 
 \text{\,\,\,であるので, }
 \sigma \tau
= 
 \begin{pmatrix}
 1& 2  &3 & 4 \\
 3& 1  &2  &4 \\
 \end{pmatrix} 
 \text{である.}
$$

\end{exa}


\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
\text{}
\begin{itemize}
\item $
\epsilon =
  \begin{pmatrix}
 1& 2  &\cdots &n\\
 1& 2  &\cdots &n\\
 \end{pmatrix} $を\underline{単位置換}という.
 \item  
 $ \sigma =
  \begin{pmatrix}
 1& 2  &\cdots &n\\
 k_1& k_2  &\cdots &k_n\\
 \end{pmatrix} 
$について, 
$
  \begin{pmatrix}
 k_1& k_2  &\cdots &k_n\\
 1& 2  &\cdots &n\\
 \end{pmatrix} 
$を\underline{$\sigma$の逆置換}と言い$\sigma^{-1}$で表す.
\end{itemize}
  \end{dfn}
 \end{tcolorbox}

\begin{exa} 
$\sigma = 
\begin{pmatrix}
 1& 2  &3 & 4 & 5\\
 4& 5  &1  &3 &2\\
 \end{pmatrix} 
$
とするとき
$
\sigma^{-1}
=
\begin{pmatrix}
 4& 5  &1  &3 &2\\
 1& 2  &3 & 4 & 5\\
 \end{pmatrix} 
 =
 \begin{pmatrix}
 1& 2  &3 & 4 & 5\\
 3& 5  &4  &1 &2\\
 \end{pmatrix} 
 \text{である.}
$
\end{exa}

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
 $ \sigma =
  \begin{pmatrix}
 k_1& k_2  &\cdots &k_l\\
 k_2& k_3  &\cdots &k_1\\
 \end{pmatrix} 
$となる置換$\sigma$を\underline{巡回置換}と言い
$\sigma =
  \begin{pmatrix}
 k_1& k_2  &\cdots &k_l\\
 \end{pmatrix} 
$と表す.

特に $ \sigma =
  \begin{pmatrix}
 k_1& k_2  \\
 k_2& k_1 \\
 \end{pmatrix} 
$となる巡回置換を\underline{互換}と言い$\sigma =
  \begin{pmatrix}
 k_1& k_2 \\
 \end{pmatrix} 
$と表す.
  \end{dfn}
 \end{tcolorbox}


\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
任意の置換$\sigma$は互換の積$\tau_1 \cdots \tau_{l}$で表わすことができ, $l$の偶奇は$\sigma$によってのみ定まる.
  \end{thm}
 \end{tcolorbox}
 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
置換$\sigma$が互換の積$\tau_1 \cdots \tau_{l}$で表せられているとする.
\begin{itemize}
\item $\sgn (\sigma) = (-1)^{l}$とし, これを\underline{$\sigma$の符号}と呼ぶ.
\item $\sgn (\sigma) = 1$なる置換$\sigma$を\underline{偶置換}といい, $\sgn (\sigma) = -1$なる置換$\sigma$を\underline{奇置換}という.
\end{itemize}
  \end{dfn}
 \end{tcolorbox}
 
 \begin{exa}
 $
 \sigma 
  =
 \begin{pmatrix}
 1& 2  &3 & 4 & 5 & 6 & 7\\
 4& 1  &6  &2 &7 & 5 & 3\\
 \end{pmatrix} 
 $を互換の積で表し, その符号を求めよ.
 
 (解). 
 $1 \overset{\sigma}{\rightarrow} 4 \overset{\sigma}{\rightarrow}2 \overset{\sigma}{\rightarrow}1 $と変化し,  
  $3 \overset{\sigma}{\rightarrow} 6\overset{\sigma}{\rightarrow}5 \overset{\sigma}{\rightarrow}7 \overset{\sigma}{\rightarrow}3$と変化するので, 
  $$
  \sigma = 
   \begin{pmatrix}
 1& 4 &2 
 \end{pmatrix} 
    \begin{pmatrix}
 3& 6 &5 &7
 \end{pmatrix} 
 \text{である.}
  $$
  さらに
  $   \begin{pmatrix}
 1& 4 &2 
 \end{pmatrix} 
 = 
 \begin{pmatrix}
 1& 4  
 \end{pmatrix} 
 \begin{pmatrix}
 4 &2 
 \end{pmatrix},
\begin{pmatrix}
 3& 6 &5 &7
 \end{pmatrix} 
 =
 \begin{pmatrix}
 3& 6  
 \end{pmatrix} 
  \begin{pmatrix}
 6& 5  
 \end{pmatrix} 
  \begin{pmatrix}
 5& 7  
 \end{pmatrix} 
 $
 であるので, 
 $$
\sigma= 
\begin{pmatrix}
 1& 4  
 \end{pmatrix} 
 \begin{pmatrix}
 4 &2 
 \end{pmatrix}
 \begin{pmatrix}
 3& 6  
 \end{pmatrix} 
  \begin{pmatrix}
 6& 5  
 \end{pmatrix} 
  \begin{pmatrix}
 5& 7  
 \end{pmatrix} 
 $$
 となり, $\sgn(\sigma)= (-1)^{5}=-1$である.
 
 \end{exa}

  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}置換$\sigma, \tau$について, 
    $\sgn(\epsilon) = 1$, $\sgn(\sigma^{-1}) = \sgn(\sigma)$, 
$\sgn(\sigma \tau) = \sgn(\sigma) \sgn(\tau) $が成り立つ(ただし$\epsilon$は単位置換とする).
  \end{prop}
 \end{tcolorbox}
 
 
  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
$S_n$を$n$文字置換の集合とし, $A_n$を$n$文字置換の集合とする.
  \end{dfn}
 \end{tcolorbox}
専門用語で$S_n$は対称群と言い, $A_n$は交代群と言う.

  \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}\text{}
    \begin{itemize}
      \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item $S_n$の個数は$n!$個である.
\item 偶置換と奇置換の個数は同じである.
\item $A_n$の個数は$\frac{n!}{2}$個である.
\item $\sigma, \tau \in A_n$ならば$\sigma \tau \in A_n$
    \end{itemize}
  \end{prop}
 \end{tcolorbox}

\subsection{行列式の定義と性質1.  \cite[3.2]{M}}

\subsubsection{行列式の定義}
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
$n$次正方行列$A = (a_{ij})$について
$$
\det(A) =  \sum_{\sigma \in S_n}\sgn(\sigma) 
a_{1 \sigma(1)} a_{2 \sigma(2)} \cdots a_{n \sigma(n)} 
\text{を\underline{$A$の行列式}と言う.}
$$
 $A$の行列式は$\det(A)$, $|A|$, 
$
\begin{vmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
a_{21}& a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
a_{n1}& a_{n2} & \cdots &a_{nn} \\
\end{vmatrix}
$
ともかく.
  \end{dfn}
 \end{tcolorbox}

\begin{exa}
\label{2jidet}
$A = 
  \begin{pmatrix}
a_{11}& a_{12}\\
a_{21}& a_{22}\\
 \end{pmatrix} 
$
とすると$\det(A) = a_{11}a_{22} - a_{12}a_{21}$である.

(証).
$S_2 = \left\{   \begin{pmatrix}
1& 2\\
1& 2\\
 \end{pmatrix} , 
   \begin{pmatrix}
1&2\\
2& 1\\
 \end{pmatrix} 
  \right\}$
  であるので, $A$の行列式は
  \begin{align*}
  \det(A) &= 
  \sgn \begin{pmatrix}
1& 2\\
1& 2\\
 \end{pmatrix} a_{11}a_{22}
 +
  \sgn \begin{pmatrix}
1& 2\\
2& 1\\
 \end{pmatrix} a_{12}a_{21}
 =
 a_{11}a_{22} - a_{12}a_{21}.
  \end{align*}

\end{exa}

\begin{exa}
$A = 
  \begin{pmatrix}
a_{11}& a_{12} & a_{13}\\
a_{21}& a_{22} & a_{23}\\
a_{31}& a_{32} & a_{33}\\
 \end{pmatrix} 
$
の行列式を求める.

$S_3 = \left\{   
\begin{pmatrix}
1& 2 &3\\
1& 2 &3\\
 \end{pmatrix} , 
\begin{pmatrix}
1& 2 &3\\
2& 1 &3\\
 \end{pmatrix} , 
\begin{pmatrix}
1& 2 &3\\
1& 3 &2\\
 \end{pmatrix} , 
 \begin{pmatrix}
1& 2 &3\\
3& 2 &1\\
 \end{pmatrix} , 
 \begin{pmatrix}
1& 2 &3\\
2& 3 &1\\
 \end{pmatrix} , 
 \begin{pmatrix}
1& 2 &3\\
3& 1 &2\\
 \end{pmatrix}
  \right\}$
  であるので, $A$の行列式は
  
  \begin{align*}
  \det(A) 
  &= 
  \sgn \begin{pmatrix}
1& 2 &3\\
1& 2 &3\\
 \end{pmatrix}
 a_{11}a_{22}a_{33}
 +
   \sgn \begin{pmatrix}
1& 2 &3\\
2& 1 &3\\
 \end{pmatrix} 
 a_{12}a_{21}a_{33}
 +
\sgn \begin{pmatrix}
1& 2 &3\\
1& 3 &2\\
 \end{pmatrix} 
 a_{11}a_{23}a_{32} 
  \\%%%
  &+
\sgn  \begin{pmatrix}
1& 2 &3\\
3& 2 &1\\
 \end{pmatrix}
 a_{13}a_{22}a_{31} 
 +
\sgn  \begin{pmatrix}
1& 2 &3\\
2& 3 &1\\
 \end{pmatrix}
 a_{12}a_{23}a_{31} 
  +
\sgn   \begin{pmatrix}
1& 2 &3\\
3& 1 &2\\
 \end{pmatrix}
 a_{13}a_{21}a_{32} 
 \\%%
   &= a_{11}a_{22}a_{33}- a_{12}a_{21}a_{33}- a_{11}a_{23}a_{32} 
   - a_{13}a_{22}a_{31}  + a_{12}a_{23}a_{31}  +  a_{13}a_{21}a_{32} 
  \end{align*}
  以上より
  $
 \det(A)= 
 a_{11}a_{22}a_{33}+ a_{12}a_{23}a_{31}  +  a_{13}a_{21}a_{32} 
- a_{11}a_{23}a_{32}     - a_{13}a_{22}a_{31}  - a_{12}a_{21}a_{33}
  $
  である.
\end{exa}
\begin{rema}
2次正方行列や3次正方行列の行列式は視覚的に綺麗に表わすことができる(サラスの公式と呼ばれる).
\end{rema}


\subsubsection{行列式の計算方法}

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
    \label{determinant0}
$A,B$を$n$次正方行列とする.
\begin{enumerate}


\item 
$
\begin{vmatrix}
a_{11}& a_{12} & \cdots &a_{1n} \\
0 	   & a_{22} & \cdots &a_{2n} \\
\vdots& \vdots	&	\ddots   &	\vdots \\
0	& a_{n2} & \cdots &a_{nn} \\
\end{vmatrix}
=a_{11}
\begin{vmatrix}
 a_{22} & \cdots &a_{2n} \\
 \vdots	&	\ddots   &	\vdots \\
 a_{n2} & \cdots &a_{nn} \\
\end{vmatrix}
$.
\item 
$
\begin{vmatrix}
a_{11}& a_{12} & a_{13} &\cdots &a_{1n-1}&a_{1n} \\
0 	   & a_{22} & a_{23} &\cdots&a_{2n-1} &a_{2n} \\
0 	   & 0  		& a_{33} &\cdots &a_{3n-1}&a_{3n} \\
\vdots& \vdots	&  \ddots &\ddots&	\vdots  &	\vdots \\
0	& 0      		&      	&\ddots	&a_{n-1n-1} &a_{n-1n} \\
0	& 0      		&     \cdots	&	\cdots&0		&a_{nn} \\
\end{vmatrix}
=a_{11}a_{22}\cdots a_{nn}
$.

\item  
$
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots&	 	  &	\vdots \\
b_{i1} + c_{i1} & \cdots &b_{in} + c_{in} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
=
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots&	 	  &	\vdots \\
b_{i1}  & \cdots &b_{in}  \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
+
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots&	 	  &	\vdots \\
c_{i1} & \cdots & c_{in} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
$.

\end{enumerate}
  \end{thm}
 \end{tcolorbox}

 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
   \label{determinant}
$A$を$n$次正方行列とする.
\begin{enumerate}

\item  1つの行を$c$倍すると行列式は$c$倍される:
$
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots&	 	  &	\vdots \\
ca_{i1} & \cdots &ca_{in} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
=
c
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots&	 	  &	\vdots \\
a_{i1} & \cdots & a_{in} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
$.
\item 2つの行を入れ替えたら, 行列式は$-1$倍される:
$$
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots& 		   &	\vdots \\
a_{j1} & \cdots & a_{jn} \\
\vdots&	 	  &	\vdots \\
a_{i1} & \cdots & a_{in} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
= (-1)
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots&	 	  &	\vdots \\
a_{i1} & \cdots & a_{in} \\
\vdots& 		   &	\vdots \\
a_{j1} & \cdots & a_{jn} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}.
$$
\item 第$i$行の$c$倍を第$j$行に加えても行列式は変わらない:
$$
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots& 		   &	\vdots \\
a_{j1} +ca_{i1}& \cdots & a_{jn} +ca_{in}\\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}
= 
\begin{vmatrix}
a_{11}&  \cdots &a_{1n} \\
\vdots& 		   &	\vdots \\
a_{j1} & \cdots & a_{jn} \\
\vdots& 		   &	\vdots \\
a_{n1}	& \cdots &a_{nn} \\
\end{vmatrix}.
$$
\end{enumerate}
  \end{thm}
 \end{tcolorbox}
 特に上の定理から基本変形を用いれば行列式を簡単に計算できる．
 
  \begin{exa}
 $
 \begin{pmatrix}
 1&3&4\\
 -2&-5&7\\
 -3&2&-1\\
 \end{pmatrix}
$
の行列式は次のように求められる. 

\begin{align*}
 &\begin{vmatrix}
 1&3&4\\
 -2&-5&7\\
 -3&2&-1\\
 \end{vmatrix}
 \overset{\text{定理\ref{determinant}.(3)} } {=}
 \begin{vmatrix}
 1&3&4\\
 0&1&15\\
 0&11&11\\
 \end{vmatrix}
 \overset{\text{定理\ref{determinant0}.(1)} } {=}
 1
 \begin{vmatrix}
1&15\\
11&11\\
 \end{vmatrix}
  \overset{\text{定理\ref{determinant}.(1)} } {=}
 11
 \begin{vmatrix}
1&15\\
1&1\\
 \end{vmatrix}\overset{\text{例 \ref{2jidet}} } {=}
 11 \left\{ 1 \times 1 - 15 \times 1 \right\} 
 =
 -154.
 \end{align*}
 
\end{exa}



 \begin{exa}
 $
 \begin{pmatrix}
 2&-4&-5&3\\
 -6&13&14&1\\
 1&-2&-2&-8\\
 2&-5&0&5\\
 \end{pmatrix}
$
の行列式は次のように求められる. 

\begin{align*}
 &\begin{vmatrix}
 2&-4&-5&3\\
 -6&13&14&1\\
 1&-2&-2&-8\\
 2&-5&0&5\\
 \end{vmatrix}
 \overset{\text{定理\ref{determinant}.(2)} } {=}
 (-1)
  \begin{vmatrix}
   1&-2&-2&-8\\
 -6&13&14&1\\
 2&-4&-5&3\\
 2&-5&0&5\\
 \end{vmatrix}
  \overset{\text{定理\ref{determinant}.(3)} }  {=}
 (-1)
  \begin{vmatrix}
   1&-2&-2&-8\\
 0&1 &2  &-47\\
 0& 0&-1&19\\
 0&-1&4&21\\
 \end{vmatrix}
\\ %%%
& \overset{\text{定理\ref{determinant0}.(1)} } {=}
 (-1)
  \begin{vmatrix}
1 &2  &-47\\
 0&-1&19\\
-1&4&21\\
 \end{vmatrix}
  \overset{\text{定理\ref{determinant}.(3)} } {=}
   (-1)
  \begin{vmatrix}
1 &2  &-47\\
 0&-1&19\\
 0&6&-26\\
 \end{vmatrix}
 \overset{\text{定理\ref{determinant0}.(1)} } {=}
  (-1)
    \begin{vmatrix}
-1&19\\
6&-26\\
 \end{vmatrix}
 \\ %%
 & \overset{\text{例 \ref{2jidet}} } {=}
 (-1)\left\{(-1)\times (-26) - 6\times 19\right\} = 88.
\end{align*}

 \end{exa}

\begin{ques}

行列式
$
\begin{vmatrix}
 0& -3& -6 &15 \\
 -2& 5& 14 &4 \\
 1& -3& -2 &5 \\
 15 & 10& 10 &-5 \\
 \end{vmatrix} 
 $
 を計算せよ.(この問題は授業で取り扱い, 答えを板書に書きます. )
\end{ques}

\subsection{行列式の定義と性質2.  \cite[3.3]{M}}

一部の内容について, 教科書通りの証明をせず齋藤正彦著 線型代数学 (東京図書)の第3章を参考にした.

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{prop}
$a_1, \ldots, a_{n}$を行ベクトルとし, $n$次正方行列
$A = 
\begin{pmatrix}
a_1 \\ \vdots \\ a_{n}
\end{pmatrix}
$とする.
\begin{enumerate}
\item $\tau$を$n$次の置換とすると
$$
\det \begin{pmatrix}
a_{\tau(1)} \\ \vdots \\ a_{\tau(n)} 
\end{pmatrix}
= 
\sgn(\tau) \det \begin{pmatrix}
a_1 \\ \vdots \\ a_{n}
\end{pmatrix}
= \sgn(\tau) \det(A).
\text{\,\,\,(交代性)}
$$
\item $b_i, c_i$を行ベクトルとし, $\alpha, \beta$を数とすると,
$$
\det \begin{pmatrix}
a_1 \\ \vdots \\ \alpha b_i + \beta c_i \\ \vdots  \\ a_{n}
\end{pmatrix}
= 
\alpha\det \begin{pmatrix}
a_1 \\ \vdots \\  b_i \\ \vdots  \\ a_{n}
\end{pmatrix}
+
\beta
\det \begin{pmatrix}
a_1 \\ \vdots \\ c_i \\ \vdots  \\ a_{n}
\end{pmatrix}
\text{\,\,\,(多重線型性)}
$$
\end{enumerate}

  \end{prop}
 \end{tcolorbox}
 

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
行ベクトル$x_1, \ldots, x_n$について, 数
$F\begin{pmatrix}
x_1 \\ \vdots \\ x_{n}
\end{pmatrix}$
を対応させる関数$F$を考える.
この$F$が交代性と多重線型性を満たすとき, 
$$
F\begin{pmatrix}
x_1 \\ \vdots \\ x_{n}
\end{pmatrix}
=
F\begin{pmatrix}
f_1 \\ \vdots \\ f_{n}
\end{pmatrix}
\det
\begin{pmatrix}
x_1 \\ \vdots \\ x_{n}
\end{pmatrix}
\text{となる.}
$$
ここで$f_i =
\begin{pmatrix}
0 & \cdots&\overset{i}{\hat{1}}&\cdots &0
\end{pmatrix}
$
という行ベクトルとする.

特に行列$A$に対して数$F(A)$を対応させる関数が, 行に関して交代性と多重線型性を満たすとき
$F(A) =F(E_n) \det(A)$となる.
  \end{thm}
 \end{tcolorbox}
 
 
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
    $A,B$を$n$次正方行列とする. 
    \begin{enumerate}
   \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}   
 \item $\det({}^{t} A) =\det(A)$.
\item $\det(AB)=(\det(A))(\det(B)) = \det(BA)$.
\end{enumerate}
  \end{thm}
 \end{tcolorbox}
 
 \begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
    $A,B$を$n$次正方行列とする. 
        \begin{enumerate}
    \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}   
\item $\det(A) \neq 0$であることと$A$が正則であることは同値.
\item $AB=E_n$ならば, $A$は正則で$B$は$A$の逆行列である. 
\end{enumerate}
  \end{thm}
 \end{tcolorbox}
 
 


\subsection{余因子行列とクラメルの公式\cite[3.4節]{M}}
\subsubsection{余因子行列}
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
    $n$次正方行列$A=(a_{ij})$の$i$行と$j$列を取り除いた$n-1$次正方行列を$\tilde{A}_{ij}$とかく(この授業だけの記法). つまり
  $$
  \tilde{A}_{ij}
  =
    \begin{pmatrix}
a_{11}&   \cdots &a_{1j-1}&a_{1j+1}&\cdots&a_{1n} \\
\vdots&   		& \vdots &\vdots &   		&\vdots  \\
a_{i-11}&   \cdots &a_{i-1j-1}&a_{i-1j+1}&\cdots&a_{i-1n} \\
a_{i+11}&   \cdots &a_{i+1j-1}&a_{i+1j+1}&\cdots&a_{i+1n} \\
\vdots&   		& \vdots &\vdots &   		&\vdots  \\
a_{n1}&   \cdots &a_{nj-1}&a_{nj+1}&\cdots&a_{nn} \\
\end{pmatrix}
\text{とする.}
$$
    \end{dfn}
 \end{tcolorbox}
\begin{exa}
$A=
\begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{pmatrix}
$
のとき, 
$  \tilde{A}_{11} =(a_{22})$, $  \tilde{A}_{12} =(a_{21})$, $  \tilde{A}_{21} =(a_{12})$, $  \tilde{A}_{22} =(a_{11})$.
\end{exa}
\begin{exa}
$
A=
\begin{pmatrix}
a_{11} & a_{12}&a_{13} \\
a_{21} & a_{22}&a_{23} \\
a_{31} & a_{32}&a_{33} \\
\end{pmatrix}
$
のとき, 
$  \tilde{A}_{12} =
\begin{pmatrix}
a_{21} & a_{23} \\
a_{31} & a_{33}
\end{pmatrix}
$, 
$  \tilde{A}_{22} =
\begin{pmatrix}
a_{11} & a_{13} \\
a_{31} & a_{33}
\end{pmatrix}
$, 
$  \tilde{A}_{31} =
\begin{pmatrix}
a_{12} & a_{13} \\
a_{22} & a_{23}
\end{pmatrix}
$.
\end{exa}

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{dfn}
    $n$次正方行列$A=(a_{ij})$について, $\tilde{A} =(b_{ij})$を
    \underline{$
    b_{ij} = (-1)^{i+j} \det(\tilde{A}_{ji})$}
    で定める.
 \underline{$\tilde{A}$を$A$の余因子行列}という.
    \end{dfn}
 \end{tcolorbox}
\begin{exa}
\label{inverse_2}
$
\begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{pmatrix}
$
のときの余因子行列$\tilde{A} $を求める.
$  \tilde{A}_{11} =(a_{22})$, $  \tilde{A}_{12} =(a_{21})$, $  \tilde{A}_{21} =(a_{12})$, $  \tilde{A}_{22} =(a_{11})$より次が成り立つ.
\begin{itemize}
  \setlength{\parskip}{0cm} 
  \setlength{\itemsep}{0cm}
\item $\tilde{A} $の$(1,1)$成分は$(-1)^{1+1}\det( \tilde{A}_{11}) = a_{22}$.
\item $\tilde{A} $の$(1,2)$成分は$(-1)^{1+2}\det( \tilde{A}_{21}) = -a_{12}$.
\item $\tilde{A} $の$(2,1)$成分は$(-1)^{2+1}\det( \tilde{A}_{12}) = -a_{21}$.
\item $\tilde{A} $の$(2,2)$成分は$(-1)^{2+2}\det( \tilde{A}_{22}) = a_{11}$.
\end{itemize}
以上より余因子行列$\tilde{A} = 
\begin{pmatrix}
a_{22} &- a_{12} \\
-a_{21} & a_{11}
\end{pmatrix}$となる.
\end{exa}


\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
 $A$を$n$次正方行列とする.
 \begin{enumerate}
\item %$i=1, \ldots, n, j=1, \ldots, n$について
任意の$1 \leqq i \leqq n, 1 \leqq j\leqq n$なる$i,j$について, 次が成り立つ.
 \begin{align*}
 \det(A) & =(-1)^{1+j}a_{1j}\det(\tilde{A}_{1j}) + \cdots +(-1)^{n+j}a_{nj}\det(\tilde{A}_{nj}) 
 \\
 &=(-1)^{i+1}a_{i1}\det(\tilde{A}_{i1}) + \cdots +(-1)^{i+n}a_{in}\det(\tilde{A}_{in}).
  \end{align*}
  これを\underline{余因子展開}という.
 \item $A\tilde{A} = \tilde{A}A =(\det A)E_n$. 特に$\det(A)\neq0$ならば$A^{-1} = \frac{1}{\det A} \tilde{A}$.
 \end{enumerate}
     \end{thm}
 \end{tcolorbox}

\begin{exa}行列
$A=
\begin{pmatrix}
2 & 7&13 & 5\\
5 & 3&8 & 2\\
0 & 0 & 9  & 4\\
0 & 0&-2 & 1\\
\end{pmatrix}
$の行列式$\det(A)$を余因子展開で求める.

\begin{align*}
\det(A) 
&= 
(-1)^{1+1}a_{11}\det(\tilde{A}_{11}) + (-1)^{2+1}a_{21}\det(\tilde{A}_{21}) + (-1)^{3+1}a_{31}\det(\tilde{A}_{31}) + (-1)^{4+1}a_{41}\det(\tilde{A}_{41}) 
\\ %%
&=
2 
\begin{vmatrix}
 3&8 & 2\\
0 & 9  & 4\\
0&-2 & 1\\
\end{vmatrix}
- 5 
\begin{vmatrix}
 7&13 & 5\\
0 & 9  & 4\\
0&-2 & 1\\
\end{vmatrix}
+0
\begin{vmatrix}
 7&13 & 5\\
 3&8 & 2\\
0&-2 & 1\\
\end{vmatrix}
-0
\begin{vmatrix}
 7&13 & 5\\
 3&8 & 2\\
0 & 9  & 4\\
\end{vmatrix}
\\ %%
&=2 
\begin{vmatrix}
 3&8 & 2\\
0 & 9  & 4\\
0&-2 & 1\\
\end{vmatrix}
- 5 
\begin{vmatrix}
 7&13 & 5\\
0 & 9  & 4\\
0&-2 & 1\\
\end{vmatrix}
\\%%
&=2 \times 3
\begin{vmatrix}
9  & 4\\
-2 & 1\\
\end{vmatrix}
-5 \times 7
\begin{vmatrix}
9  & 4\\
-2 & 1\\
\end{vmatrix}
=(2 \times 3 - 5 \times 7) \times (9 \times 1 - 4 \times (-2)) = -493.
\end{align*}
\end{exa}


\begin{exa}
2次正方行列
$
A = 
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
$について, $\det A =ad-bc \neq0$ならば$A$は正則であり, 
例\ref{inverse_2}から
$$
A^{-1} = \frac{1}{\det A} \tilde{A}
=\frac{1}{ad-bc}
\begin{pmatrix}
d & -b \\
-c & a
\end{pmatrix}.
$$
\end{exa}

\begin{ques}
行列式
$
\begin{vmatrix}
3 & 5&1 & 2&-1\\
2 & 6&0 & 9&1\\
0 & 0& 7& 1&2\\
0 & 0& 3& 2&5\\
0 & 0& 0& 0&-6\\
\end{vmatrix}
$を計算せよ.
(この問題は授業で取り扱い, 答えを板書に書きます. )

\end{ques}

\subsubsection{クラメルの公式}

\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
$A$を正則な$n$次正方行列とし, 列ベクトル$a_1, \ldots, a_{n}$を用いて
$
A = 
\begin{pmatrix}
a_1 & \cdots & a_{n}
\end{pmatrix}
$
と表されているとする.
このとき連立1次方程式$A \bm{x} =\bm{b}$の解は次のようになる.
$$
\bm{x}= \begin{pmatrix}
x_1 \\ \vdots \\ x_{n}
\end{pmatrix}, 
x_i = \frac{\det
\begin{pmatrix}
a_1 & \cdots& \bm{b}&\cdots & a_{n}
\end{pmatrix}
}{\det A}.
$$
    \end{thm}
 \end{tcolorbox}
\begin{exa}
$
A = 
\begin{pmatrix}
5 &1\\
3&2 \\ 
\end{pmatrix}
$, $
\bm{b} = 
\begin{pmatrix}
3\\
2 \\ 
\end{pmatrix}
$
とする. 
連立1次方程式$A \bm{x} =\bm{b}$の解を
$
\bm{x}= \begin{pmatrix}
x_1 \\x_2
\end{pmatrix} 
$
とすると,
$$
x_1 = \frac{\det
\begin{pmatrix}
 \bm{b}& a_{2}
\end{pmatrix}
}{\det A}
= 
\frac{ 
\begin{vmatrix}
3&1\\
2&2 \\
\end{vmatrix}
}
{
\begin{vmatrix}
5&1\\
3&2 \\
\end{vmatrix}
}
=\frac{4}{7} 
\text{, }
x_2 = \frac{\det
\begin{pmatrix}
a_{1}& \bm{b}
\end{pmatrix}
}{\det A}
= 
\frac{ 
\begin{vmatrix}
5&3\\
3&2 \\
\end{vmatrix}
}
{
\begin{vmatrix}
5&1\\
3&2 \\
\end{vmatrix}
}
=\frac{1}{7}
\text{となる.}
$$
\end{exa}

\subsection{特殊な形の行列式 \cite[3.5節]{M}}
\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
  \begin{enumerate}
\item (ヴァンデルモンドの行列式)
\begin{align*}
 &
 \begin{vmatrix}
1   &   1     & \cdots &  1  \\
x_1& x_2 & \cdots &x_n \\
{x_1}^{2}& {x_2}^{2} & \cdots &{x_n}^{2} \\
\vdots & \vdots    &  &\vdots \\
{x_1}^{n-1}& {x_2}^{n-1} & \cdots &{x_n}^{n-1} \\
\end{vmatrix}
= \prod_{1 \leqq i < j \leqq n} (x_j - x_i).
\\%%
%&=(x_2 - x_1)  (x_3 - x_1)  \cdots  (x_n - x_1)  (x_3- x_2)    \cdots  (x_n - x_2)  (x_4 - x_3)\cdots (x_n - x_{n-1})
%\begin{matrix}=(x_2 - x_1)  (x_3 - x_1)  \cdots  (x_n - x_1) \\\times (x_3- x_2)  (x_4 - x_2)  \cdots  (x_n - x_2) \\\times \cdots \\\times (x_n - x_{n-1}) \\ \end{matrix}
%\begin{matrix}(x_2 - x_1) & \times&  (x_3 - x_1) & \times&  \cdots &\times & (x_n - x_1) \\\end{matrix}
\end{align*}
\item (ヴァンデルモンドの行列式の応用) $b_1, \ldots, b_n, c_1, \ldots, c_n$を実数とし, $b_1, \ldots, b_n$は相異なると仮定する.
 このとき実数係数の$n$次式$f(x) = x^{n} +  a_1 x^{n-1} +  \cdots +  a_{n-1} x + a_{n}$があって, 任意の$i = 1, \ldots, n$について$f(b_i) =c_i $となる.

  \end{enumerate}
    \end{thm}
 \end{tcolorbox}
$\prod_{1 \leqq i < j \leqq n}$は積の記号で, $\prod_{1 \leqq i < j \leqq n} (x_j - x_i)$は「$1 \leqq i < j \leqq n$を満たす$(i,j)$について$ (x_j - x_i)$を全てかけた数」を表している.



\begin{tcolorbox}[
    colback = white,
    colframe = green!35!black,
    fonttitle = \bfseries,
    breakable = true]
    \begin{thm}
$$
 \begin{vmatrix}
a_0   &   -1   &0 &0 & \cdots &  0 \\
a_1   &   x    &-1  &0 & \cdots &  0 \\
a_2   &   0    & x   &-1 & \cdots &  0 \\
\vdots  &    \vdots   &   &\ddots & \ddots &  0 \\
a_{n-1}&   0    & 0   &                  & x&  -1\\
a_n   &   0   & 0   &0 & \cdots &  x\\
\end{vmatrix}
=a_0 x^{n} +  a_1 x^{n-1} +  \cdots +  a_{n-1} x + a_{n}.
$$
    \end{thm}
 \end{tcolorbox}
  
\begin{thebibliography}{n}
\bibitem[教科書]{M}
三宅敏恒, "線形代数学　初歩からジョルダン標準形へ", 培風館.
\end{thebibliography}
 

\end{document}